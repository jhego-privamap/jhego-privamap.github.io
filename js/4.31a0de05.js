(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"07a4":function(e,t,i){"use strict";i("ac6a"),i("cadf"),i("06db"),i("5df3"),i("f400");var n=i("2b0e"),s=i("2f62");n["default"].use(s["a"]),t["a"]=new s["a"].Store({state:{selectedTreeElement:null,isRetryLocate:!1,geolocDisabled:!1,isDirectionMode:!1,itineraryStartTreeElt:"-1",isNavigationMode:!1,selectDepartureOnMap:0,selectArrivalOnMap:0,isNoDirectionOnChange:!1,isTreeSelectOpen:!1,isNavigationImage:!1,remainingDistance:0,totalDistance:0,isShowQrCode:!1,qrCodeURL:"",isInterior:!1,interiorId:null,isPreview:!1,styleByTypeId:{},eltsPropsById:new Map},mutations:{setSelectedTreeElement:function(e,t){e.selectedTreeElement=t},setRetryLocate:function(e,t){e.isRetryLocate=t},setGeolocDisabled:function(e,t){e.geolocDisabled=t},setDirectionMode:function(e,t){e.isDirectionMode=t},setItineraryStartTreeElt:function(e,t){e.itineraryStartTreeElt=t},setNavigationMode:function(e,t){e.isNavigationMode=t},setSelectDepartureOnMap:function(e,t){e.selectDepartureOnMap=t},setSelectArrivalOnMap:function(e,t){e.selectArrivalOnMap=t},setNoDirectionOnChange:function(e,t){e.isNoDirectionOnChange=t},setTreeSelectOpen:function(e,t){e.isTreeSelectOpen=t},setNavigationImage:function(e,t){e.isNavigationImage=t},setRemainingDistance:function(e,t){e.remainingDistance=t},setTotalDistance:function(e,t){console.log("setTotalDistance triggered with"),console.log(t),e.totalDistance=t},setShowQrDialog:function(e,t){console.log(t),e.isShowQrCode=t},setQrCodeURL:function(e,t){console.log(t),e.qrCodeURL=t},setInterior:function(e,t){e.isInterior=t},setInteriorId:function(e,t){e.interiorId=t},setPreview:function(e,t){e.isPreview=t},setStyleByTypeId:function(e,t){e.styleByTypeId=t},setEltsPropsById:function(e,t){console.log("setEltsPropsById triggered with"),console.log(t),e.eltsPropsById=t}}})},"713b":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-layout",{staticClass:"noDoubleTap",attrs:{view:"lHr Lpr lFr",onClick:"{e => e.preventDefault()}"}},[i("meta",{attrs:{name:"viewport",content:"width=device-width, user-scalable=no"}}),i("q-header",{staticClass:"noDoubleTap",attrs:{elevated:"",id:"Qheader"}},[i("q-toolbar",{staticClass:"q-pa-xs",attrs:{id:"upperToolbar"}},[e.isDirections||e.isNavigation||e.isPreview?i("q-btn",{staticClass:"backBtn",attrs:{padding:"5px",flat:"",color:"white",size:"lg",icon:"fas fa-arrow-left"},on:{click:e.cancelDir}}):e._e(),e.isNavigation||e.isPreview?i("NavPreviewHeaderComponent",{attrs:{navArrivalName:e.navArrivalName}}):e._e(),i("div",{staticClass:"row"},[e.isDirections?i("div",{staticClass:"col-1"},[i("div",{staticClass:"start-dest-icon"}),i("q-icon",{staticClass:"start-dest-icon col-1 q-pr-sm",attrs:{name:"mdi-record-circle-outline",size:"sm"}}),i("q-icon",{staticClass:"dots-icon col-1 q-pr-sm",attrs:{name:"fas fa-ellipsis-v",size:"xs"}}),i("q-icon",{staticClass:"start-dest-icon col-1 q-pr-sm",attrs:{name:"location_on",size:"sm"}}),i("div",{staticClass:"start-dest-icon"})],1):e._e(),i("div",{staticClass:"researchTree",class:e.isDirections?"col-11":""},[e.isDirections?i("treeselect",{staticClass:"treeSelectElement q-pb-xs",class:e.getClassTreeSelectDeparture(),attrs:{id:"treeSelectDeparture",multiple:!1,clearable:!1,searchable:!0,disabled:!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"close-on-select":!0,"always-open":!1,"append-to-body":!1,options:e.treeSelectEltOnMap,limit:3,"max-height":200,"flatten-search-results":!1,autoLoadRootOptions:!1,placeholder:"Sélectionner un élément"},on:{open:e.onOpenTreeSelectDeparture,close:e.onCloseTreeSelectDeparture},model:{value:e.startElement,callback:function(t){e.startElement=t},expression:"startElement"}}):e._e(),e.isNavigation||e.isPreview?e._e():i("treeselect",{staticClass:"treeSelectElement",class:e.getClassTreeSelectArrival(),attrs:{id:"treeSelectArrival",multiple:!1,clearable:!1,searchable:!0,disabled:!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"close-on-select":!0,"always-open":!1,"append-to-body":!1,options:e.isInterior?e.interiorTypes:e.isDirections?e.treeSelectEltOnMap:e.types,limit:3,"max-height":200,"flatten-search-results":!1,placeholder:"Sélectionner un élément"},on:{open:e.onOpenTreeSelectArrival,close:e.onCloseTreeSelectArrival},model:{value:e.selectedElement,callback:function(t){e.selectedElement=t},expression:"selectedElement"}})],1)]),e.isDirections?i("q-btn",{staticClass:"exchangeBtn",attrs:{padding:"5px",flat:"",color:"white",size:"lg",icon:"fas fa-exchange-alt"},on:{click:e.exchangeDir}}):e._e(),e.isDirections||e.isNavigation||e.isPreview?e._e():i("q-btn",{attrs:{padding:"1px",flat:"",color:"white",size:"28px",icon:"img:statics\\QrCode.png"},on:{click:function(t){return e.showQrCode()}}}),i("QrCodeGenerator")],1)],1),i("q-page-container",[i("router-view")],1)],1)},s=[],r=(i("ac4d"),i("8a81"),i("1c4c"),i("28a5"),i("6762"),i("2fdb"),i("6b54"),i("7f7f"),i("ac6a"),i("cadf"),i("06db"),i("5df3"),i("f400"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{attrs:{persistent:""},model:{value:e.isDialog,callback:function(t){e.isDialog=t},expression:"isDialog"}},[i("q-card",[i("q-toolbar",[i("q-avatar",[i("q-icon",{attrs:{name:"fas fa-qrcode"}})],1),i("q-toolbar-title",[e._v("QrCode")]),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(t){return e.closeDialog()}}})],1),i("q-card-section",{attrs:{id:"qrCodeContainer"}},[i("canvas",{attrs:{id:"qrCodeCanvas"}})]),i("q-card-actions",{attrs:{align:"center"}},[i("q-btn",{attrs:{icon:"fas fa-copy",label:"Copier dans le presse-papier",color:"primary","no-caps":""},on:{click:e.copyToClipboardClick}})],1)],1)],1)}),a=[],o=i("c4a7"),l=i.n(o),c=i("cdde"),d=i("07a4"),u={name:"QrCodeDialog",data:function(){return{isDialog:!1,qrCode:null,store:d["a"]}},created:function(){},computed:{isShowQrCode:{get:function(){return this.store.state.isShowQrCode},set:function(e){this.store.commit("setShowQrDialog",e)}},qrCodeURL:function(){return this.store.state.qrCodeURL}},watch:{isShowQrCode:function(e){if(e){this.isDialog=!0;var t=this;setTimeout((function(){var e=document.getElementById("qrCodeCanvas");this.qrCode=new l.a({element:e,background:"white",backgroundAlpha:.8,foreground:"black",foregroundAlpha:.8,level:"H",size:Math.min(e.offsetWidth,560),value:document.location.origin+t.qrCodeURL})}),0)}}},methods:{copyToClipboardClick:function(){var e=this;Object(c["a"])(document.location.origin+this.qrCodeURL).then((function(){e.$q.notify({message:"Lien copié dans le presse-papier."})})).catch((function(){}))},closeDialog:function(){this.isShowQrCode=!1}}},p=u,h=i("2877"),m=i("eebe"),f=i.n(m),v=i("24e8"),g=i("f09f"),y=i("65c6"),D=i("cb32"),S=i("0016"),C=i("6ac5"),b=i("9c40"),T=i("a370"),w=i("4b7e"),I=i("7f67"),E=Object(h["a"])(p,r,a,!1,null,null,null),M=E.exports;f()(E,"components",{QDialog:v["a"],QCard:g["a"],QToolbar:y["a"],QAvatar:D["a"],QIcon:S["a"],QToolbarTitle:C["a"],QBtn:b["a"],QCardSection:T["a"],QCardActions:w["a"]}),f()(E,"directives",{ClosePopup:I["a"]});var O=i("ca17"),q=i.n(O),A=(i("542c"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"q-ml-sm"},[i("div",{staticClass:"row"},[i("div",{staticClass:"navTowardLabel"},[e._v("\n      Vers :\n    ")]),i("div",{staticClass:"navArrivalNameDiv q-pl-xs"},[e._v("\n      "+e._s(e.navArrivalName)+"\n    ")])]),i("div",{staticClass:"row"},[e.isNavigation?i("div",{staticClass:"navArrivalDistDiv q-pl-xs"},[e._v("\n      "+e._s(e.remainingDistance)+" /\n    ")]):e._e(),i("div",{staticClass:"navArrivalDistDiv q-pl-xs"},[e._v("\n      "+e._s(e.totalDistance)+" km\n    ")])])])}),Q=[],N={name:"NavPreviewHeaderComponent",props:{navArrivalName:String},data:function(){return{store:d["a"]}},computed:{remainingDistance:{get:function(){return this.store.state.remainingDistance},set:function(e){this.store.commit("setRemainingDistance",e)}},totalDistance:{get:function(){return this.store.state.totalDistance},set:function(e){this.store.commit("setTotalDistance",e)}},isNavigation:{get:function(){return this.store.state.isNavigationMode},set:function(e){this.store.commit("setNavigationMode",e)}}},watch:{},methods:{}},B=N,P=Object(h["a"])(B,A,Q,!1,null,null,null),L=P.exports;function x(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_(e))){var t=0,i=function(){};return{s:i,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s,r=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){a=!0,s=e},f:function(){try{r||null==n.return||n.return()}finally{if(a)throw s}}}}function _(e,t){if(e){if("string"===typeof e)return k(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var R={name:"MainLayout",components:{QrCodeGenerator:M,Treeselect:q.a,NavPreviewHeaderComponent:L},data:function(){return{types:[],treeSelectEltOnMap:[{id:0,label:"Sélectionner un élément sur la carte"},{id:-1,label:"Ma position"}],interiorTypes:[],store:d["a"],eltLabelsById:new Map,navArrivalName:"arrivée",totalDistance:"total"}},created:function(){var e=this,t=[],i="https://privamap-dev.azurewebsites.net/api/elementType/all",n={method:"GET",redirect:"follow"};fetch(i,n).then((function(e){return e.text()})).then((function(i){t=JSON.parse(i).ElementTypes;for(var n=0;n<t.length;n++){for(var s=[],r=0;r<t[n].Elements.length;r++){var a={id:t[n].id+"-"+t[n].Elements[r].id,label:t[n].Elements[r].name};e.eltLabelsById.set(t[n].Elements[r].id,t[n].Elements[r].name),s.push(a);var o=t[n].Elements[r].sons;o&&o.length>0&&e.eltsPropsById.set(t[n].Elements[r].id,{sons:o,floors:t[n].Elements[r].floors})}var l={id:t[n].id,label:t[n].name,children:s};e.types.push(l),e.styleByTypeId[t[n].id.toString()]=t[n].elementTypeStyle}e.treeSelectEltOnMap=e.treeSelectEltOnMap.concat(e.types),t.length>0&&(e.selectedElement=t[0].id)})).catch((function(e){return console.log("error",e)}))},computed:{isDirections:{get:function(){return this.store.state.isDirectionMode},set:function(e){this.store.commit("setDirectionMode",e)}},isNavigation:{get:function(){return this.store.state.isNavigationMode},set:function(e){this.store.commit("setNavigationMode",e)}},isPreview:{get:function(){return this.store.state.isPreview},set:function(e){this.store.commit("setPreview",e)}},styleByTypeId:{get:function(){return this.store.state.styleByTypeId},set:function(e){this.store.commit("setStyleByTypeId",e)}},eltsPropsById:{get:function(){return this.store.state.eltsPropsById},set:function(e){this.store.commit("setEltsPropsById",e)}},isGeolocDisabled:function(){return this.store.state.geolocDisabled},remainingDistance:function(){return this.store.state.remainingDistance},isInterior:function(){return this.store.state.isInterior},selectedElement:{get:function(){return this.store.state.selectedTreeElement},set:function(e){void 0!==e&&!e.toString().includes("-")&&this.isDirections?(this.selectArrivalOnMap=0!==e?parseInt(e):1,this.selectDepartureOnMap=0,this.store.commit("setSelectedTreeElement",null)):(this.store.commit("setSelectedTreeElement",e),e&&e.toString().includes("-")&&parseInt(e)>0?this.navArrivalName=this.eltLabelsById.get(parseInt(e.split("-")[1])):-1===parseInt(e)&&(this.navArrivalName="Ma position"))}},startElement:{get:function(){return this.store.state.itineraryStartTreeElt},set:function(e){e.toString().includes("-")?this.store.commit("setItineraryStartTreeElt",e):(this.isDirections&&(this.selectDepartureOnMap=0!==e?parseInt(e):1,this.selectArrivalOnMap=0),this.store.commit("setItineraryStartTreeElt",null))}},selectDepartureOnMap:{get:function(){return this.store.state.selectDepartureOnMap},set:function(e){this.store.commit("setSelectDepartureOnMap",e)}},selectArrivalOnMap:{get:function(){return this.store.state.selectArrivalOnMap},set:function(e){this.store.commit("setSelectArrivalOnMap",e)}},isShowQrCode:{get:function(){return this.store.state.isShowQrCode},set:function(e){this.store.commit("setShowQrDialog",e)}},qrCodeURL:{get:function(){return this.store.state.qrCodeURL},set:function(e){this.store.commit("setQrCodeURL",e)}},interiorId:{get:function(){return this.store.state.interiorId},set:function(e){this.store.commit("setInteriorId",e)}}},watch:{isInterior:function(e){if(e){var t=this.eltsPropsById.get(parseInt(this.interiorId)).sons;if(t){var i=this.getAllDescendants(t);this.fillInteriorTypes(i)}}else this.types.length&!this.isDirections&&(this.selectedElement=this.types[0].id)},isGeolocDisabled:function(e){var t=[{id:0,label:"Sélectionner un élément sur la carte"}];e?(t.push({id:-1,label:"Ma position",isDisabled:!0}),"-1"===this.startElement&&(this.startElement="1-112"),"-1"===this.selectedElement&&(this.selectedElement="1-112")):t.push({id:-1,label:"Ma position"}),this.treeSelectEltOnMap=t.concat(this.types)}},methods:{cancelDir:function(){this.isDirections=!1,this.isNavigation=!1,this.isPreview=!1,this.selectArrivalOnMap=0,this.selectDepartureOnMap=0},getClassTreeSelectDeparture:function(){var e=this.selectDepartureOnMap?"highlightTreeSelect":"";return this.isDirections&&(""!==e&&(e+=" "),e+="directionTreeSelectDeparture"),e},getClassTreeSelectArrival:function(){var e=this.selectArrivalOnMap?"highlightTreeSelect":"";return this.isDirections&&(""!==e&&(e+=" "),e+="directionTreeSelectArrival"),e},onOpenTreeSelectArrival:function(e){if(this.isDirections){var t=document.getElementById("treeSelectDeparture");t.classList.remove("highlightTreeSelect")}else this.store.commit("setTreeSelectOpen",!0)},onOpenTreeSelectDeparture:function(e){var t=document.getElementById("treeSelectArrival");t.classList.remove("highlightTreeSelect")},onCloseTreeSelectArrival:function(e){if(this.selectDepartureOnMap){var t=document.getElementById("treeSelectDeparture");t.classList.add("highlightTreeSelect")}this.isDirections||this.store.commit("setTreeSelectOpen",!1)},onCloseTreeSelectDeparture:function(e){if(this.selectArrivalOnMap){var t=document.getElementById("treeSelectArrival");t.classList.add("highlightTreeSelect")}},exchangeDir:function(){this.store.commit("setNoDirectionOnChange",!0);var e=this.startElement;this.startElement=this.selectedElement,this.selectedElement=e},showQrCode:function(){this.qrCodeURL="",this.isShowQrCode=!0},getAllDescendants:function(e){var t,i=e,n=x(e);try{for(n.s();!(t=n.n()).done;){var s=t.value;this.eltsPropsById.has(s)&&this.eltsPropsById.get(s).sons&&(i=i.concat(this.eltsPropsById.get(s).sons))}}catch(r){n.e(r)}finally{n.f()}return i},fillInteriorTypes:function(e){var t=0;this.interiorTypes=[];var i,n=x(this.types);try{for(n.s();!(i=n.n()).done;){var s=i.value,r=s.children.filter((function(t){return e.includes(parseInt(t.id.split("-")[1]))}));if(r.length>0){var a={id:s.id,label:s.label,children:r};this.interiorTypes.push(a)}if(t+=r.length,t>=e.length)break}}catch(o){n.e(o)}finally{n.f()}}}},U=R,z=i("4d5a"),j=i("e359"),G=i("09e3"),H=Object(h["a"])(U,n,s,!1,null,null,null);t["default"]=H.exports;f()(H,"components",{QLayout:z["a"],QHeader:j["a"],QToolbar:y["a"],QBtn:b["a"],QIcon:S["a"],QPageContainer:G["a"]})}}]);