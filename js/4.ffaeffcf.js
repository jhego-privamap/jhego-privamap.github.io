(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"07a4":function(e,t,n){"use strict";var r=n("2b0e"),a=n("2f62");r["default"].use(a["a"]),t["a"]=new a["a"].Store({state:{selectedTreeElement:null,isRetryLocate:!1,geolocDisabled:!1,isDirectionMode:!1,itineraryStartTreeElt:"-1",isNavigationMode:!1,isSelectDepartureOnMap:!1,isSelectArrivalOnMap:!1,isNoDirectionOnChange:!1},mutations:{setSelectedTreeElement:function(e,t){console.log("setSelectedTreeElement triggered with"),console.log(t),e.selectedTreeElement=t},setRetryLocate:function(e,t){console.log("setRetryLocate triggered with"),console.log(t),e.isRetryLocate=t},setGeolocDisabled:function(e,t){console.log("setGeolocDisabled triggered with"),console.log(t),e.geolocDisabled=t},setDirectionMode:function(e,t){console.log("setDirectionMode triggered with"),console.log(t),e.isDirectionMode=t},setItineraryStartTreeElt:function(e,t){console.log("setItineraryStartTreeElt triggered with"),console.log(t),e.itineraryStartTreeElt=t},setNavigationMode:function(e,t){console.log("setNavigationMode triggered with"),console.log(t),e.isNavigationMode=t},setSelectDepartureOnMap:function(e,t){console.log("setSelectDepartureOnMap triggered with"),console.log(t),e.isSelectDepartureOnMap=t},setSelectArrivalOnMap:function(e,t){console.log("setSelectArrivalOnMap triggered with"),console.log(t),e.isSelectArrivalOnMap=t},setNoDirectionOnChange:function(e,t){console.log("setNoDirectionOnChange triggered with"),console.log(t),e.isNoDirectionOnChange=t}}})},"713b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{staticClass:"noDoubleTap",attrs:{view:"lHr Lpr lFr",onClick:"{e => e.preventDefault()}"}},[n("meta",{attrs:{name:"viewport",content:"width=device-width, user-scalable=no"}}),n("q-header",{staticClass:"noDoubleTap",attrs:{elevated:"",id:"Qheader"}},[n("q-toolbar",{staticClass:"q-pa-xs",attrs:{id:"upperToolbar"}},[e.isDirections||e.isNavigation?n("q-btn",{staticClass:"backBtn",attrs:{padding:"5px",flat:"",color:"white",size:"lg",icon:"fas fa-arrow-left"},on:{click:e.cancelDir}}):e._e(),e.isNavigation?n("div",{staticClass:"q-ml-sm"},[e._v("\n        Vers :\n        "),n("div",{staticClass:"navArrivalNameDiv"},[e._v("\n          "+e._s(e.navArrivalName)+"\n        ")])]):e._e(),n("div",{staticClass:"researchTree"},[e.isDirections?n("treeselect",{staticClass:"treeSelectElement q-pb-xs",class:e.getClassTreeSelectDeparture(),attrs:{id:"treeSelectDeparture",multiple:!1,clearable:!1,searchable:!0,disabled:!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"close-on-select":!0,"always-open":!1,"append-to-body":!1,options:e.treeSelectEltOnMap,limit:3,"max-height":200,"flatten-search-results":!1,autoLoadRootOptions:!1,placeholder:"Sélectionner un élément"},on:{open:e.onOpenTreeSelectDeparture,close:e.onCloseTreeSelectDeparture},model:{value:e.startElement,callback:function(t){e.startElement=t},expression:"startElement"}}):e._e(),e.isNavigation?e._e():n("treeselect",{staticClass:"treeSelectElement",class:e.getClassTreeSelectArrival(),attrs:{id:"treeSelectArrival",multiple:!1,clearable:!1,searchable:!0,disabled:!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"close-on-select":!0,"always-open":!1,"append-to-body":!1,options:e.isDirections?e.treeSelectEltOnMap:e.types,limit:3,"max-height":200,"flatten-search-results":!1,placeholder:"Sélectionner un élément"},on:{open:e.onOpenTreeSelectArrival,close:e.onCloseTreeSelectArrival},model:{value:e.selectedElement,callback:function(t){e.selectedElement=t},expression:"selectedElement"}})],1),e.isDirections?n("q-btn",{staticClass:"exchangeBtn",attrs:{padding:"5px",flat:"",color:"white",size:"lg",icon:"fas fa-exchange-alt"},on:{click:e.exchangeDir}}):e._e(),e.isDirections||e.isNavigation?e._e():n("q-btn",{attrs:{padding:"1px",flat:"",color:"white",size:"28px",icon:"img:statics\\QrCode.png"},on:{click:function(t){e.showQrCode=!e.showQrCode}}}),n("QrCodeGenerator",{attrs:{showDialog:e.showQrCode}})],1)],1),n("q-page-container",[n("router-view")],1)],1)},a=[],i=(n("28a5"),n("6b54"),n("6762"),n("2fdb"),n("7f7f"),n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("f400"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-dialog",{attrs:{persistent:""},model:{value:e.isDialog,callback:function(t){e.isDialog=t},expression:"isDialog"}},[n("q-card",[n("q-toolbar",[n("q-avatar",[n("q-icon",{attrs:{name:"fas fa-qrcode"}})],1),n("q-toolbar-title",[e._v("QrCode")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),n("q-card-section",{attrs:{id:"qrCodeContainer"}},[n("canvas",{attrs:{id:"qrCodeCanvas"}})]),n("q-card-actions",{attrs:{align:"center"}},[n("q-btn",{attrs:{icon:"fas fa-copy",label:"Copier dans le presse-papier",color:"primary","no-caps":""},on:{click:e.copyToClipboardClick}})],1)],1)],1)}),o=[],l=n("c4a7"),s=n.n(l),c=n("cdde"),d={name:"QrCodeDialog",props:{showDialog:null},data:function(){return{isDialog:!1,qrCode:null}},created:function(){},watch:{showDialog:function(){this.isDialog=!0,setTimeout((function(){var e=document.getElementById("qrCodeCanvas");this.qrCode=new s.a({element:e,background:"white",backgroundAlpha:.8,foreground:"black",foregroundAlpha:.8,level:"H",size:Math.min(e.offsetWidth,560),value:document.location.origin})}),0)}},methods:{copyToClipboardClick:function(){var e=this;Object(c["a"])(document.location.origin).then((function(){e.$q.notify({message:"Lien copié dans le presse-papier."})})).catch((function(){}))}}},p=d,u=n("2877"),h=n("eebe"),g=n.n(h),m=n("24e8"),v=n("f09f"),f=n("65c6"),S=n("cb32"),D=n("0016"),b=n("6ac5"),C=n("9c40"),T=n("a370"),E=n("4b7e"),M=n("7f67"),O=Object(u["a"])(p,i,o,!1,null,null,null),w=O.exports;g()(O,"components",{QDialog:m["a"],QCard:v["a"],QToolbar:f["a"],QAvatar:S["a"],QIcon:D["a"],QToolbarTitle:b["a"],QBtn:C["a"],QCardSection:T["a"],QCardActions:E["a"]}),g()(O,"directives",{ClosePopup:M["a"]});var y=n("ca17"),A=n.n(y),q=(n("542c"),n("07a4")),Q={name:"MainLayout",components:{QrCodeGenerator:w,Treeselect:A.a},data:function(){return{types:[],treeSelectEltOnMap:[{id:0,label:"Sélectionner un élément sur la carte"},{id:-1,label:"Ma position"}],store:q["a"],showQrCode:!1,eltLabelsById:new Map,navArrivalName:"not found"}},created:function(){var e=this,t=[],n="https://privamap-dev.azurewebsites.net/api/elementType/all",r={method:"GET",redirect:"follow"};fetch(n,r).then((function(e){return e.text()})).then((function(n){t=JSON.parse(n).ElementTypes;for(var r=0;r<t.length;r++){for(var a=[],i=0;i<t[r].Elements.length;i++){var o={id:t[r].id+"-"+t[r].Elements[i].id,label:t[r].Elements[i].name};e.eltLabelsById.set(t[r].Elements[i].id,t[r].Elements[i].name),a.push(o)}var l={id:t[r].id,label:t[r].name,children:a};e.types.push(l)}e.treeSelectEltOnMap=e.treeSelectEltOnMap.concat(e.types),t.length>0&&(e.selectedElement=t[0].id)})).catch((function(e){return console.log("error",e)}))},computed:{isDirections:function(){return this.store.state.isDirectionMode},isNavigation:function(){return this.store.state.isNavigationMode},selectedElement:{get:function(){return this.store.state.selectedTreeElement},set:function(e){0===e?(this.isDirections&&(this.isSelectArrivalOnMap=!0,this.isSelectDepartureOnMap=!1),this.store.commit("setSelectedTreeElement",null)):(this.store.commit("setSelectedTreeElement",e),console.log("setter selectedElement"),console.log(e),e&&e.toString().includes("-")&&parseInt(e)>0?this.navArrivalName=this.eltLabelsById.get(parseInt(e.split("-")[1])):-1===parseInt(e)&&(this.navArrivalName="Ma position"))}},startElement:{get:function(){return this.store.state.itineraryStartTreeElt},set:function(e){0===e?(this.isDirections&&(this.isSelectDepartureOnMap=!0,this.isSelectArrivalOnMap=!1),this.store.commit("setItineraryStartTreeElt",null)):this.store.commit("setItineraryStartTreeElt",e)}},isSelectDepartureOnMap:{get:function(){return this.store.state.isSelectDepartureOnMap},set:function(e){this.store.commit("setSelectDepartureOnMap",e)}},isSelectArrivalOnMap:{get:function(){return this.store.state.isSelectArrivalOnMap},set:function(e){this.store.commit("setSelectArrivalOnMap",e)}},isSearchDeparture:{get:function(){return this.store.state.isSelectDepartureOnMap},set:function(e){this.store.commit("setSelectDepartureOnMap",e)}}},watch:{},methods:{cancelDir:function(){this.store.commit("setDirectionMode",!1),this.store.commit("setNavigationMode",!1)},getClassTreeSelectDeparture:function(){console.log("getClassTreeSelectDeparture");var e=this.isSelectDepartureOnMap?"highlightTreeSelect":"";return this.isDirections&&(""!==e&&(e+=" "),e+="directionTreeSelectDeparture"),e},getClassTreeSelectArrival:function(){var e=this.isSelectArrivalOnMap?"highlightTreeSelect":"";return this.isDirections&&(""!==e&&(e+=" "),e+="directionTreeSelectArrival"),e},onOpenTreeSelectArrival:function(e){if(console.log("onOpenTreeSelectArrival"),console.log(e),this.isDirections){var t=document.getElementById("treeSelectDeparture");t.classList.remove("highlightTreeSelect")}},onOpenTreeSelectDeparture:function(e){var t=document.getElementById("treeSelectArrival");t.classList.remove("highlightTreeSelect")},onCloseTreeSelectArrival:function(e){if(console.log("onCloseTreeSelectArrival"),this.isSelectDepartureOnMap){var t=document.getElementById("treeSelectDeparture");t.classList.add("highlightTreeSelect")}},onCloseTreeSelectDeparture:function(e){if(console.log("onCloseTreeSelectDeparture"),console.log("this.isSelectArrivalOnMap"),console.log(this.isSelectArrivalOnMap),this.isSelectArrivalOnMap){var t=document.getElementById("treeSelectArrival");t.classList.add("highlightTreeSelect")}},exchangeDir:function(){this.store.commit("setNoDirectionOnChange",!0);var e=this.startElement;this.startElement=this.selectedElement,this.selectedElement=e}}},N=Q,k=n("4d5a"),x=n("e359"),I=n("09e3"),L=Object(u["a"])(N,r,a,!1,null,null,null);t["default"]=L.exports;g()(L,"components",{QLayout:k["a"],QHeader:x["a"],QToolbar:f["a"],QBtn:C["a"],QPageContainer:I["a"]})}}]);