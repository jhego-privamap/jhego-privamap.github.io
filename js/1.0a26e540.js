(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"07a4":function(e,t,o){"use strict";var i=o("2b0e"),a=o("2f62");i["a"].use(a["a"]),t["a"]=new a["a"].Store({state:{importedDataGeoJSON:null,isImageEditor:!1,isPolygonEditor:!1,isPolylineEditor:!1,imageLayers:[],modifyImageById:null,isInfoPanelDisplayed:!1,isRouteLevel:!1,selectedRouteDirection:2},mutations:{setImportedDataGeoJSON:function(e,t){console.log("setImportedDataGeoJSON triggered with"),console.log(t),e.importedDataGeoJSON=t},setImageEditor:function(e,t){console.log("setImageEditor triggered with"),console.log(t),e.isImageEditor=t},setPolygonEditor:function(e,t){console.log("setPolygonEditor triggered with"),console.log(t),e.isPolygonEditor=t},setRouteEditor:function(e,t){console.log("setRouteEditor triggered with"),console.log(t),e.isPolylineEditor=t},setImageLayers:function(e,t){console.log("setImageLayers triggered with"),console.log(t),e.imageLayers=t},setModifyImageById:function(e,t){console.log("setModifyImageById triggered with"),console.log(t),e.modifyImageById=t},setInfoPanelDisplayed:function(e,t){console.log("setInfoPanelDisplayed triggered with"),console.log(t),e.isInfoPanelDisplayed=t},setRouteLevel:function(e,t){console.log("setRouteLevel triggered with"),console.log(t),e.isRouteLevel=t},setSelectedRouteDirection:function(e,t){console.log("setSelectedRouteDirection triggered with"),console.log(t),e.selectedRouteDirection=t}}})},"0e66":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"map-page"},[o("div",{staticClass:"row"},[o("div",{class:e.isInfoPanelDisplayed?"smallMap":"largeMap"},[o("map-component")],1),e.isInfoPanelDisplayed?o("div",{staticClass:"infoColumn"},[e.isRouteLevel?e._e():o("information-card"),e.isRouteLevel?o("route-information-card"):e._e()],1):e._e()])])},a=[],n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"flex map-component",attrs:{sync:""}},[o("q-card",{staticStyle:{flex:"1"},attrs:{id:"map"}},[o("div",{class:e.isImageEditor?"mapImageEditor":"mapFull",attrs:{oncontextmenu:"return false;"}},[o("l-map",{ref:"map",staticClass:"description mapContainer",attrs:{zoom:e.zoom,center:e.center,options:{zoomControl:!1}},on:{"update:zoom":e.zoomUpdated,"update:center":e.centerUpdated,"update:bounds":e.boundsUpdated}},[o("l-control-zoom",{attrs:{position:"topleft"}}),o("l-control-layers",{ref:"control",attrs:{position:"topleft",autoZIndex:!1}}),e._l(e.tileProviders,(function(e){return o("l-tile-layer",{key:e.name,attrs:{name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"}})})),o("l-control-scale",{attrs:{position:"bottomleft",imperial:!1,metric:!0}})],2)],1),o("q-inner-loading",{attrs:{showing:e.isLoading}},[o("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1),o("q-list",{staticStyle:{"min-width":"100px",visibility:"hidden"},attrs:{id:"contextMenu"}},[e.isSelectAvailable?o("q-item",{attrs:{clickable:""}},[o("q-item-section",{on:{click:e.rightClickSelectVertex}},[e._v("Sélectionner")])],1):e._e(),e.isSelectAvailable?o("q-item",{attrs:{clickable:""}},[o("q-item-section",{on:{click:e.rightClickCreateLine}},[e._v("Relier au point sélectionné")])],1):e._e(),e.isUnselectAvailable?o("q-item",{attrs:{clickable:""}},[o("q-item-section",{on:{click:e.rightClickUnselectVertex}},[e._v("Déselectionner")])],1):e._e()],1),e.isImageEditor||e.isPolygonEditor?e._e():o("q-fab",{staticStyle:{position:"absolute",bottom:"30px",right:"8px"},attrs:{square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"img:statics/action.png",direction:"up"}},[o("q-fab-action",{attrs:{square:"",padding:"xs","external-label":"",color:"white","text-color":"mapButton",icon:"img:statics/action.png"},on:{click:function(t){return e.centerMap()}}}),o("q-fab-action",{attrs:{square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"image"},on:{click:function(t){return e.importImage()}}}),o("q-fab-action",{attrs:{square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"alarm"}}),o("q-fab-action",{attrs:{square:"",padding:"xs","external-label":"",color:"white","text-color":"mapButton",icon:"airplay"}})],1),e.isImageEditor?o("q-btn",{staticStyle:{position:"absolute",bottom:"82px",right:"8px"},attrs:{"external-label":"",square:"",padding:"xs",color:"mapButton",icon:"clear"},on:{click:function(t){return e.cancelModification()}}}):e._e(),e.isImageEditor?o("q-btn",{staticStyle:{position:"absolute",bottom:"40px",right:"8px"},attrs:{"external-label":"",square:"",padding:"xs",color:"mapButton",icon:"done"},on:{click:function(t){return e.confirmImage()}}}):e._e(),o("q-btn-group",{staticClass:"floating-btn-group",staticStyle:{position:"absolute",top:"10px",right:"10px"}},[e.isRouteLevel&&e.isPolylineEditorAdd?o("q-btn",{staticClass:"floating-btn confirm-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-check"},on:{click:function(t){return e.cancelAddPolyline()}}}):e._e(),e.isRouteLevel?o("q-btn",{staticClass:"floating-btn add-polyline-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"timeline"},on:{click:function(t){return e.addPolyline()}}}):e._e()],1),o("q-btn-group",{staticClass:"floating-btn-group",staticStyle:{position:"absolute",top:"10px",right:"10px"}},[e.isPolygonEditor&&e.isPolygonEditorAdd?o("q-btn",{staticClass:"floating-btn undo-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"mdi-undo-variant"},on:{click:function(t){return e.removeLastVertexPolygon()}}}):e._e(),e.isPolygonEditor&&e.isPolygonEditorAdd?o("q-btn",{staticClass:"floating-btn confirm-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-check"},on:{click:function(t){return e.confirmAddPolygon()}}}):e._e(),e.isPolygonEditor&&e.isPolygonEditorAdd?o("q-btn",{staticClass:"floating-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-times"},on:{click:function(t){return e.cancelAddPolygon()}}}):e._e(),e.isPolygonEditor?o("q-btn",{staticClass:"floating-btn add-polygon-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"mdi-shape-polygon-plus"},on:{click:function(t){return e.addPolygon()}}}):e._e()],1),o("q-btn-group",{staticClass:"floating-btn-group",staticStyle:{position:"absolute",top:"57px",right:"10px"}},[(e.isPolygonEditor||e.isRouteLevel)&&e.isPolygonEditorMod?o("q-btn",{staticClass:"floating-btn confirm-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-check"},on:{click:function(t){return e.confirmModPolygon()}}}):e._e(),(e.isPolygonEditor||e.isRouteLevel)&&e.isPolygonEditorMod?o("q-btn",{staticClass:"floating-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-times"},on:{click:function(t){return e.cancelModPolygon()}}}):e._e(),e.isPolygonEditor||e.isRouteLevel?o("q-btn",{staticClass:"floating-btn edit-btn",attrs:{disabled:e.isEditable,"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-pen"},on:{click:function(t){return e.editPolygon()}}}):e._e()],1),o("q-btn-group",{staticClass:"floating-btn-group",staticStyle:{position:"absolute",top:"104px",right:"10px"}},[(e.isPolygonEditor||e.isRouteLevel)&&e.isPolygonEditorDel?o("q-btn",{staticClass:"floating-btn confirm-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-check"},on:{click:function(t){return e.confirmDelPolygon()}}}):e._e(),(e.isPolygonEditor||e.isRouteLevel)&&e.isPolygonEditorDel?o("q-btn",{staticClass:"floating-btn",attrs:{"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-times"},on:{click:function(t){return e.cancelDelPolygon()}}}):e._e(),e.isPolygonEditor||e.isRouteLevel?o("q-btn",{staticClass:"floating-btn edit-btn",attrs:{disabled:e.isEditable,"external-label":"",square:"",padding:"xs",color:"white","text-color":"mapButton",icon:"fas fa-trash-alt"},on:{click:function(t){return e.deletePolygon()}}}):e._e()],1),e.isImageEditor?o("q-item",{staticClass:"sliderOpacity"},[o("q-item-section",{attrs:{avatar:""}},[o("q-icon",{attrs:{color:"primary",name:"opacity"}})],1),o("q-item-section",[o("q-slider",{attrs:{min:0,max:1,step:.01,dense:"",color:"primary"},on:{input:e.onOpacityChange},model:{value:e.opacity,callback:function(t){e.opacity=t},expression:"opacity"}})],1)],1):e._e()],1),o("import-dialog",{attrs:{dialogOptions:e.dialogImageOptions},on:{importedData:e.loadImage}})],1)},s=[],r=(o("ac6a"),o("cadf"),o("06db"),o("5df3"),o("f400"),o("2699")),l=o("a40a"),c=o("d371"),d=o("9ee8"),g=o("c8b6"),p=o("e11e"),h=o.n(p),m=o("feb7"),u=o("aeff"),y=o.n(u),L=o("b24d"),f=o.n(L),I=o("32ef"),b=o.n(I),M=o("4596"),w=o.n(M),T=o("3b38"),E=o("260b");o("20d6b"),o("6cc5"),o("5fbf");h.a.ImageOverlay.Rotated=h.a.ImageOverlay.extend({initialize:function(e,t,o,i,a){"string"===typeof e?this._url=e:this._rawImage=e,this._topLeft=h.a.latLng(t),this._topRight=h.a.latLng(o),this._bottomLeft=h.a.latLng(i),h.a.setOptions(this,a)},onAdd:function(e){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(h.a.DomUtil.addClass(this._rawImage,"leaflet-interactive"),this.addInteractiveTarget(this._rawImage)),e.on("zoomend resetview",this._reset,this),this.getPane().appendChild(this._image),this._reset()},onRemove:function(e){e.off("zoomend resetview",this._reset,this),h.a.ImageOverlay.prototype.onRemove.call(this,e)},_initImage:function(){var e=this._rawImage;this._url&&(e=h.a.DomUtil.create("img"),e.style.display="none",this.options.crossOrigin&&(e.crossOrigin=""),e.src=this._url,this._rawImage=e),h.a.DomUtil.addClass(e,"leaflet-image-layer");var t=this._image=h.a.DomUtil.create("div","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));this._updateZIndex(),t.appendChild(e),t.onselectstart=h.a.Util.falseFn,t.onmousemove=h.a.Util.falseFn,e.onload=function(){this._reset(),e.style.display="block",this.fire("load")}.bind(this),e.alt=this.options.alt},_reset:function(){var e=this._image;if(this._map){var t=this._map.latLngToLayerPoint(this._topLeft),o=this._map.latLngToLayerPoint(this._topRight),i=this._map.latLngToLayerPoint(this._bottomLeft),a=o.subtract(t).add(i),n=h.a.bounds([t,o,i,a]),s=n.getSize(),r=t.subtract(n.min);this._bounds=h.a.latLngBounds(this._map.layerPointToLatLng(n.min),this._map.layerPointToLatLng(n.max)),h.a.DomUtil.setPosition(e,n.min),e.style.width=s.x+"px",e.style.height=s.y+"px";var l=this._rawImage.width,c=this._rawImage.height;if(l&&c){var d=o.subtract(t),g=i.subtract(t);this._rawImage.style.transformOrigin="0 0",this._rawImage.style.transform="matrix("+d.x/l+", "+d.y/l+", "+g.x/c+", "+g.y/c+", "+r.x+", "+r.y+")"}}},reposition:function(e,t,o){this._topLeft=h.a.latLng(e),this._topRight=h.a.latLng(t),this._bottomLeft=h.a.latLng(o),this._reset()},getTopLeft:function(){return this._topLeft},getTopRight:function(){return this._topRight},getBottomLeft:function(){return this._bottomLeft},setUrl:function(e){return this._url=e,this._rawImage&&(this._rawImage.src=e),this}}),h.a.imageOverlay.rotated=function(e,t,o,i,a){return new h.a.ImageOverlay.Rotated(e,t,o,i,a)};var x=o("07a4"),C=o("e526"),v=(o("f33e"),o("1d2c"),o("cf23")),D=o.n(v),S=o("6af5"),P=o.n(S),k=[{name:"Esri.WorldImagery",visible:!0,attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},{name:"GeoportailFrance.orthos",visible:!1,attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',url:"https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/jpeg&LAYER=ORTHOIMAGERY.ORTHOPHOTOS&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}"},{name:"GeoportailFrance.maps",visible:!1,attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',url:"https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/jpeg&LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}"},{name:"GeoportailFrance.ignMaps",visible:!1,attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',url:"https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/jpeg&LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}"},{name:"OSM",visible:!1,url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'Map data: &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'},{name:"Stadia",visible:!1,attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"},{name:"Stamen",visible:!1,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.png"}],N=[{name:"Stamen.TonerHybrid",visible:!1,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-hybrid/{z}/{x}/{y}{r}.png"}],R={components:{LMap:r["a"],LTileLayer:l["a"],LControlScale:c["a"],LControlLayers:d["a"],LControlZoom:g["a"],"import-dialog":C["a"]},data:function(){return{map:null,defaultIcon:new h.a.Icon({iconUrl:D.a,iconSize:[27,45],iconAnchor:[15,40]}),selectedIcon:new h.a.Icon({iconUrl:P.a,iconSize:[27,45],iconAnchor:[15,40]}),url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:15,center:h.a.latLng(50.22063232981847,3.172990350766831),tileProviders:k,orverlayProviders:N,bounds:null,imageLayer:{type:"raster",paint:{"raster-opacity":.7}},editedImageLayer:null,newImageCoord:[[50.22401551627046,3.158713465189201],[50.22401551627046,3.179662195391103],[50.2179704881745,3.17919547894098],[50.21872742410591,3.158246748739078]],imHeight:null,imWeight:null,imDiag:null,imHeightPx:6623,imWeightPx:9363,imageLayers:[],displayNewImage:!1,isImageEditor:!1,modImageMarker1:null,modImageMarker2:null,cornerCircle1:null,cornerCircle2:null,circleOptions:{steps:100,units:"kilometers",properties:{}},opacity:1,anchor1ToTopRightNormedDist:0,anchor1ToBottomLeftNormedDist:0,anchor1ToTopLeftNormedDist:0,anchor1ToBottomRightNormedDist:0,anchor2ToTopRightNormedDist:0,anchor2ToBottomLeftNormedDist:0,anchor2ToTopLeftNormedDist:0,anchor2ToBottomRightNormedDist:0,distBetweenAnchorsNormed:0,imScale:1,anchor1InUpperLeftCorner:!0,anchor2InUpperLeftCorner:!0,precision:.01,store:x["a"],buildingLayer:null,buildingStyle:{color:"#ff7800",weight:5,opacity:.65},ratio:1,dialogImageOptions:{},imageFile:null,newImage:null,imageList:[],isLoading:!1,editedImageInd:null,isPolygonEditor:!1,isPolylineEditor:!1,drawControl:null,layerControl:null,drawPluginOptions:null,circleMarkerEditorAdd:null,isPolylineEditorAdd:!1,polygonEditorAdd:null,isPolygonEditorAdd:!1,polygonEditorMod:null,isPolygonEditorMod:!1,polygonEditorDel:null,isPolygonEditorDel:!1,editableLayers:null,isEditable:!1,lastPolylineVertexId:null,linesList:new Map,backupLinesList:new Map,linesGeojson:[],linesLastId:-1,pointsList:new Map,backupPointsList:new Map,isContextMenu:!1,rightClickedVertex:null,isUnselectAvailable:!1,isSelectAvailable:!1,draftLayer:null,midpointsLayer:null,backupEditableLayers:null,selectedLineLayer:null}},created:function(){var e=this,t="http://localhost:8098/api/imageLayer/all",o={method:"GET",redirect:"follow"};fetch(t,o).then((function(e){return e.text()})).then((function(t){e.imageList=JSON.parse(t).images;for(var o=0;o<e.imageList.length;o++){var i=[parseFloat(e.imageList[o].topLeftLat),parseFloat(e.imageList[o].topLeftLng)],a=[parseFloat(e.imageList[o].topRightLat),parseFloat(e.imageList[o].topRightLng)],n=[parseFloat(e.imageList[o].bottomLeftLat),parseFloat(e.imageList[o].bottomLeftLng)],s="data:"+e.imageList[o].fileType+";base64,"+e.imageList[o].image,r=h.a.imageOverlay.rotated(s,i,a,n,{opacity:.9,interactive:!0});r.addTo(e.map),e.imageLayers.push({id:e.imageList[o].id,layer:r})}})).catch((function(e){return console.log("error",e)}))},mounted:function(){var e=this;this.map=this.$refs.map.mapObject,this.buildingLayer=h.a.geoJSON(),this.buildingLayer.addTo(this.map),this.linesLayers=new h.a.FeatureGroup,this.linesLayers.on("click",this.onLineClick),this.map.addLayer(this.linesLayers),this.selectedLineLayer=new h.a.FeatureGroup,this.map.addLayer(this.selectedLineLayer),this.selectedLineLayer.setStyle({color:"#61C1D2"}),this.draftLayer=new h.a.FeatureGroup,this.map.addLayer(this.draftLayer),this.midpointsLayer=new h.a.FeatureGroup,this.midpointsLayer.on("mouseover",this.onHoverMidpoint),this.midpointsLayer.on("mouseout",this.onHoverEndMidpoint),this.midpointsLayer.on("click",this.onClickMidpoint),this.map.addLayer(this.midpointsLayer),this.editableLayers=new h.a.FeatureGroup,this.map.addLayer(this.editableLayers),this.drawPluginOptions={position:"topleft",draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#61C1D2"},repeatMode:!0},circlemarker:{radius:8,fillColor:"#61C1D2",color:"#2F52A0",weight:2,opacity:1,fillOpacity:.8,repeatMode:!0},circle:!1,rectangle:!1,polyline:!1,marker:!1},edit:{featureGroup:this.editableLayers,remove:!0}},h.a.drawLocal.draw.handlers.circlemarker.tooltip={start:"Cliquer pour placer les points de route."},h.a.drawLocal.draw.handlers.polygon.tooltip={start:"Cliquer pour commencer à dessiner une forme.",cont:"Cliquer pour continuer à dessiner la forme.",end:"Cliquer sur le premier point pour fermer la forme."},h.a.drawLocal.edit.handlers.edit.tooltip={text:"Appuyer sur la croix pour annuler les modifications.",subtext:"Faire glisser les points pour les déplacer."},h.a.drawLocal.edit.handlers.remove.tooltip={text:"Cliquer sur un élément pour le retirer."};var t=this;this.map.on("draw:created",(function(e){console.log("draw:created");var o=e.layerType,i=e.layer;"circlemarker"===o&&(i.on("contextmenu",t.onPointRightClick),i.on("click",t.onPointClick)),t.editableLayers.addLayer(i),t.drawLineToLastVertex(i._leaflet_id),console.log("page.lastPolylineVertexId"),console.log(t.lastPolylineVertexId),console.log("page.linesList"),console.log(t.linesList),t.displayCreatedLines()})),this.map.on("draw:deleted",(function(e){console.log("draw:deleted"),t.editableLayers.getLayers().length?t.isEditable=!1:t.isEditable=!0})),this.map.on("draw:editmove",(function(e){console.log("draw:editmove"),t.displayCreatedLines(),t.midpointsLayer.clearLayers(),t.addMidpoints()})),this.map.on("mousemove",(function(e){t.isPolylineEditorAdd&&t.lastPolylineVertexId&&t.draftLineToMouse(e)})),this.map.on("click",(function(e){t.isContextMenu=!1})),this.$nextTick((function(){e.addOverlays()})),this.polygonEditorAdd=new h.a.Draw.Polygon(this.map,this.drawPluginOptions.draw.polygon),this.circleMarkerEditorAdd=new h.a.Draw.CircleMarker(this.map,this.drawPluginOptions.draw.circlemarker),this.polygonEditorMod=new h.a.EditToolbar.Edit(this.map,{featureGroup:this.drawPluginOptions.edit.featureGroup,selectedPathOptions:this.drawPluginOptions.edit.selectedPathOptions}),this.polygonEditorDel=new h.a.EditToolbar.Delete(this.map,{featureGroup:this.drawPluginOptions.edit.featureGroup})},beforeDestroy:function(){clearInterval(this.timer)},computed:{selectedRouteDirection:function(){return this.store.state.selectedRouteDirection},importedDataGeoJSON:function(){return this.store.state.importedDataGeoJSON},modifyImageById:function(){return this.store.state.modifyImageById},isPolygonEditorMode:function(){return this.store.state.isPolygonEditor},isRouteLevel:function(){return this.store.state.isRouteLevel},deletedLayers:function(){return this.polygonEditorDel&&this.polygonEditorDel._deletedLayers?this.polygonEditorDel._deletedLayers._layers:[]},isInfoPanelDisplayed:function(){return this.isPolylineEditorAdd||this.selectedLineLayer.getLayers().length}},watch:{isInfoPanelDisplayed:function(e){console.log("isInfoPanelDisplayed watcher"),console.log(e),this.store.commit("setInfoPanelDisplayed",e)},isPolylineEditorAdd:function(e){console.log("isPolylineEditorAdd watcher"),console.log(e),console.log("this.selectedLineLayer.getLayers().length"),console.log(this.selectedLineLayer.getLayers().length),console.log("this.isPolylineEditorAdd || this.selectedLineLayer.getLayers().length"),console.log(this.isPolylineEditorAdd||this.selectedLineLayer.getLayers().length)},isContextMenu:function(e){console.log("isContextMenu watcher"),console.log(e),document.getElementById("contextMenu").style.visibility=e?"visible":"hidden"},deletedLayers:function(e){console.log("deletedLayers"),console.log("this.polygonEditorDel._deletedLayers"),console.log(e)},importedDataGeoJSON:function(e){var t=JSON.parse(this.store.state.importedDataGeoJSON);this.map.removeLayer(this.buildingLayer),this.buildingLayer=h.a.geoJSON(t,this.buildingStyle).addTo(this.map),this.store.commit("setInfoPanelDisplayed",!0)},imageLayers:function(e){this.store.commit("setImageLayers",e)},modifyImageById:function(e){this.isImageEditor=!0,this.store.commit("setImageEditor",!0);for(var t=0;t<this.imageLayers.length;t++)if(console.log("this.imageLayers[ind]"),console.log(this.imageLayers[t]),this.imageLayers[t].id===e){this.editedImageInd=t;break}this.editedImageLayer=this.imageLayers[this.editedImageInd].layer,this.editImage()},isPolygonEditorMode:function(e){this.isPolygonEditor=e,e?this.addPolygon():(this.cancelAddPolygon(),this.cancelModPolygon(),this.cancelDelPolygon()),this.store.commit("setInfoPanelDisplayed",e)},isRouteLevel:function(e){this.isPolylineEditor=e,e?this.addPolyline():(this.cancelAddPolyline(),this.cancelModPolygon(),this.cancelDelPolygon()),this.store.commit("setInfoPanelDisplayed",e),this.editableLayers.getLayers().length?this.isEditable=!1:this.isEditable=!0},selectedRouteDirection:function(e){console.log("this.selectedLineLayer"),console.log(this.selectedLineLayer.getLayers().length),this.selectedLineLayer.getLayers().length&&(console.log("this.selectedLineLayer.getLayers()[0]"),console.log(this.selectedLineLayer.getLayers()[0]),this.linesList.get(this.selectedLineLayer.getLayers()[0].options.id).direction=e,console.log("this.linesList"),console.log(this.linesList),this.displayCreatedLines())}},methods:{zoomUpdated:function(e){this.zoom=e},centerUpdated:function(e){this.center=e},boundsUpdated:function(e){this.bounds=e},importImage:function(){this.dialogImageOptions={placeholder:"Image File",acceptedFormats:".jpg, image/*"}},loadImage:function(e){var t=this;this.isLoading=!0,this.isImageEditor=!0,this.store.commit("setImageEditor",!0),this.imageFile=e,this.newImage=new Image,this.newImage.onload=this.addImage;var o=new FileReader;o.addEventListener("load",(function(e){t.importedData=e.target.result,t.newImage.src=t.importedData})),o.readAsDataURL(e)},addImage:function(){this.ratio=this.newImage.naturalHeight/this.newImage.naturalWidth;var e=h.a.latLng(this.newImageCoord[0]).distanceTo(h.a.latLng(this.newImageCoord[1]))*this.ratio,t=Object(m["lineString"])([[this.newImageCoord[0][1],this.newImageCoord[0][0]],[this.newImageCoord[0][1],this.newImageCoord[0][0]-10]]),o=y()(t,e/1e3,{units:"kilometers"});this.newImageCoord[3]=[o.geometry.coordinates[1],o.geometry.coordinates[0]],this.newImageCoord[2]=[this.newImageCoord[3][0],this.newImageCoord[0][1]];var i=h.a.latLng(this.newImageCoord[0]),a=h.a.latLng(this.newImageCoord[1]),n=h.a.latLng(this.newImageCoord[3]);this.editedImageLayer=h.a.imageOverlay.rotated(this.newImage,i,a,n,{opacity:this.opacity,interactive:!0}),this.editedImageLayer.addTo(this.map),this.editImage(),this.isLoading=!1},confirmImage:function(){var e=this;this.isLoading=!0;var t,o,i=this.editedImageLayer.getTopRight(),a=this.editedImageLayer.getBottomLeft(),n=this.editedImageLayer.getTopLeft(),s=this.getBottomRightCorner(i,a);if(console.log("this.editedImageInd"),console.log(this.editedImageInd),null===this.editedImageInd){t="http://localhost:8098/api/imageLayer/"+n.lat+"/"+n.lng+"/"+i.lat+"/"+i.lng+"/"+a.lat+"/"+a.lng+"/"+s.lat+"/"+s.lng+"/0";var r=new FormData;r.append("file",this.imageFile),o={method:"POST",body:r,redirect:"follow"}}else t="http://localhost:8098/api/imageLayer/coords/"+this.imageLayers[this.editedImageInd].id+"/"+n.lat+"/"+n.lng+"/"+i.lat+"/"+i.lng+"/"+a.lat+"/"+a.lng+"/"+s.lat+"/"+s.lng+"/0",o={method:"PUT",redirect:"follow"};var l=0;fetch(t,o).then((function(e){if(!e.ok)throw Error(e.statusText);return e.text()})).then((function(t){console.log("result"),console.log(t),null===e.editedImageInd?(l=JSON.parse(t).id,e.imageLayers.push({id:l,layer:e.editedImageLayer})):e.imageLayers[e.editedImageInd].layer=e.editedImageLayer,e.editedImageLayer=null,e.editedImageInd=null,e.modImageMarker1.remove(),e.modImageMarker2.remove(),e.isImageEditor=!1,e.store.commit("setImageEditor",!1),e.isLoading=!1})).catch((function(t){console.log("error",t),e.$q.notify({type:"negative",message:"Error while uploading file"}),e.isLoading=!1}))},cancelModification:function(){var e=this;if(null===this.editedImageInd)this.editedImageLayer.remove(),this.editedImageLayer=null;else{var t="http://localhost:8098/api/imageLayer/"+this.imageLayers[this.editedImageInd].id,o={method:"GET",redirect:"follow"};fetch(t,o).then((function(e){return e.text()})).then((function(t){console.log("result"),console.log(t);var o=JSON.parse(t),i=[parseFloat(o.topLeftLat),parseFloat(o.topLeftLng)],a=[parseFloat(o.topRightLat),parseFloat(o.topRightLng)],n=[parseFloat(o.bottomLeftLat),parseFloat(o.bottomLeftLng)];e.editedImageLayer.reposition(i,a,n),e.editedImageLayer=null})).catch((function(e){return console.log("error",e)}))}this.modImageMarker1.remove(),this.modImageMarker2.remove(),this.editedImageInd=null,this.isImageEditor=!1,this.store.commit("setImageEditor",!1)},onDragMarker1:function(){if(console.log("onDragMarker1"),!this.isMoveAnchorPoint1){var e=this.getImagePosition(),t=e[0],o=e[1],i=e[2];this.editedImageLayer.reposition(t,o,i)}},onDragMarker2:function(){if(console.log("onDragMarker2"),!this.isMoveAnchorPoint2){var e=this.getImagePosition(),t=e[0],o=e[1],i=e[2];this.editedImageLayer.reposition(t,o,i)}},onDragEndMarker1:function(){if(this.isMoveAnchorPoint1){var e=this.modImageMarker1.getLatLng(),t=this.editedImageLayer.getTopRight(),o=this.editedImageLayer.getBottomLeft(),i=this.editedImageLayer.getTopLeft(),a=this.getBottomRightCorner(t,o),n=t.distanceTo(o);this.imScale=n/this.imDiag,this.anchor1ToTopRightNormedDist=t.distanceTo(e)/this.imScale,this.anchor1ToBottomLeftNormedDist=o.distanceTo(e)/this.imScale,this.anchor1ToTopLeftNormedDist=i.distanceTo(e)/this.imScale,this.anchor1ToBottomRightNormedDist=a.distanceTo(e)/this.imScale,this.distBetweenAnchorsNormed=this.modImageMarker2.getLatLng().distanceTo(e)/this.imScale;var s=[O(i),O(t),O(o)],r={type:"Polygon",coordinates:[s]},l=w()(O(e),r);this.anchor1InUpperLeftCorner=l}},onDragEndMarker2:function(){if(this.isMoveAnchorPoint2){var e=this.modImageMarker2.getLatLng(),t=this.editedImageLayer.getTopRight(),o=this.editedImageLayer.getBottomLeft(),i=this.editedImageLayer.getTopLeft(),a=this.getBottomRightCorner(t,o),n=t.distanceTo(o);this.imScale=n/this.imDiag,this.anchor2ToTopRightNormedDist=t.distanceTo(e)/this.imScale,this.anchor2ToBottomLeftNormedDist=o.distanceTo(e)/this.imScale,this.anchor2ToTopLeftNormedDist=i.distanceTo(e)/this.imScale,this.anchor2ToBottomRightNormedDist=a.distanceTo(e)/this.imScale,this.distBetweenAnchorsNormed=this.modImageMarker1.getLatLng().distanceTo(e)/this.imScale;var s=[O(i),O(t),O(o)],r={type:"Polygon",coordinates:[s]},l=w()(O(e),r);this.anchor2InUpperLeftCorner=l}},onOpacityChange:function(){this.editedImageLayer.setOpacity(this.opacity)},onClickMarker1:function(){this.isMoveAnchorPoint1=!this.isMoveAnchorPoint1,this.isMoveAnchorPoint1?(this.modImageMarker1.setIcon(this.selectedIcon),this.isMoveAnchorPoint2=!1):this.modImageMarker1.setIcon(this.defaultIcon)},onClickMarker2:function(){this.isMoveAnchorPoint2=!this.isMoveAnchorPoint2,this.isMoveAnchorPoint2?(this.modImageMarker2.setIcon(this.selectedIcon),this.isMoveAnchorPoint1=!1):this.modImageMarker2.setIcon(this.defaultIcon)},getPointsFromDist:function(e,t,o,i){if(0===o)return[e];if(0===i)return[t];for(var a=b()(O(e),o/1e3,this.circleOptions).geometry.coordinates[0],n=b()(O(t),i/1e3,this.circleOptions).geometry.coordinates[0],s=f()(Object(m["lineString"])(a),Object(m["lineString"])(n)),r=[],l=0;l<s.features.length;l++)r[l]=A(s.features[l].geometry.coordinates);return r},getBottomRightCorner:function(e,t){var o=Object(T["a"])(Object(m["point"])(O(e)),Object(m["point"])(O(t)));o=o.geometry;var i={pivot:o},a=Object(m["point"])(O(e)),n=Object(E["a"])(a,2*Math.atan(this.imHeight/this.imWeight)/Math.PI*180,i);return n=A(n.geometry.coordinates),n},getTopLeftCorner:function(e,t){var o=Object(T["a"])(Object(m["point"])(O(e)),Object(m["point"])(O(t)));o=o.geometry;var i={pivot:o},a=Object(m["point"])(O(t)),n=Object(E["a"])(a,2*Math.atan(this.imHeight/this.imWeight)/Math.PI*180,i);return n=A(n.geometry.coordinates),n},getImagePosition:function(){var e=this.modImageMarker1.getLatLng(),t=this.modImageMarker2.getLatLng(),o=t.distanceTo(e);this.imScale=o/this.distBetweenAnchorsNormed;var i,a,n,s=this.getPointsFromDist(e,t,this.anchor1ToTopRightNormedDist*this.imScale,this.anchor2ToTopRightNormedDist*this.imScale),r=this.getPointsFromDist(e,t,this.anchor1ToBottomLeftNormedDist*this.imScale,this.anchor2ToBottomLeftNormedDist*this.imScale),l=[];if(s.forEach((function(e){r.forEach((function(t){l.push([e,t])}))})),l.length>1&&(l=this.filterByDiagLength(l)),1===l.length)i=h.a.latLng(l[0][0]),n=h.a.latLng(l[0][1]);else if(l.length>1)if(l=this.filterByAreaCheck(l),1===l.length)a=h.a.latLng(l[0][0]),i=h.a.latLng(l[0][1]),n=h.a.latLng(l[0][3]);else if(l.length>1){var c=this.filterByDistToCorners(l);a=c[0],i=c[1],n=c[2]}else console.log("No possible positions - All eliminated by triangle check");else console.log("No possible positions - All eliminated by diag distance check");return a||(a=this.getTopLeftCorner(h.a.latLng(i),h.a.latLng(n))),[a,i,n]},filterByDiagLength:function(e){for(var t=[],o=[],i=0;i<e.length;i++){var a=e[i],n=a[0],s=a[1],r=n.distanceTo(s)/this.imScale,l=Math.abs(r/this.imDiag-1);o.push(l),l<=this.precision&&t.push(a)}if(!t.length){var c=Math.min.apply(Math,o),d=o.indexOf(c);t.push(e[d])}return t},filterByAreaCheck:function(e){for(var t,o,i,a,n=this.modImageMarker1.getLatLng(),s=this.modImageMarker2.getLatLng(),r=[],l=0;l<e.length;l++){var c=e[l];t=h.a.latLng(c[0]),o=h.a.latLng(c[1]),a=this.getTopLeftCorner(t,o);var d=!1,g=!1,p=[O(a),O(t),O(o)],m={type:"Polygon",coordinates:[p]};if(this.anchor1InUpperLeftCorner){var u=w()(O(n),m);if(!u){console.log("rejected because anchor1 not in upper left");continue}d=!0}if(this.anchor2InUpperLeftCorner){var y=w()(O(s),m);if(!y){console.log("rejected because anchor2 not in upper left");continue}if(d){r.push([a,t,i,o]);continue}g=!0}i=this.getBottomRightCorner(t,o);var L=[O(i),O(t),O(o)],f={type:"Polygon",coordinates:[L]};if(!this.anchor1InUpperLeftCorner){var I=w()(O(n),f);if(!I){console.log("rejected because anchor1 not in lower right");continue}if(g){r.push([a,t,i,o]);continue}d=!0}if(!this.anchor2InUpperLeftCorner){var b=w()(O(s),f);b?d&&r.push([a,t,i,o]):console.log("rejected because anchor2 not in lower right")}}return r},filterByDistToCorners:function(e){for(var t,o,i,a,n,s,r,l=this.modImageMarker1.getLatLng(),c=this.modImageMarker2.getLatLng(),d=[],g=0;g<e.length;g++){var p=e[g];a=h.a.latLng(p[0]),t=h.a.latLng(p[1]),i=h.a.latLng(p[2]),o=h.a.latLng(p[3]),a||(a=this.getTopLeftCorner(h.a.latLng(t),h.a.latLng(o)));var m=l.distanceTo(a)/this.imScale,u=c.distanceTo(a)/this.imScale;i||(i=this.getBottomRightCorner(h.a.latLng(t),h.a.latLng(o)));var y=l.distanceTo(i)/this.imScale,L=c.distanceTo(i)/this.imScale,f=Math.abs(m/this.anchor1ToTopLeftNormedDist-1),I=Math.abs(u/this.anchor2ToTopLeftNormedDist-1),b=Math.abs(y/this.anchor1ToBottomRightNormedDist-1),M=Math.abs(L/this.anchor2ToBottomRightNormedDist-1),w=f+I+b+M;d.push(w)}var T=Math.min.apply(Math,d),E=d.indexOf(T);return n=h.a.latLng(e[E][0]),s=h.a.latLng(e[E][1]),r=h.a.latLng(e[E][3]),[n,s,r]},editImage:function(){var e=this.editedImageLayer.getTopRight(),t=this.editedImageLayer.getBottomLeft(),o=this.editedImageLayer.getTopLeft();this.imWeight=o.distanceTo(e),this.imHeight=t.distanceTo(o),this.imDiag=t.distanceTo(e),this.modImageMarker1=new h.a.Marker(e,{draggable:"true",icon:this.defaultIcon}),this.modImageMarker1.addTo(this.map),this.modImageMarker1.on("drag",this.onDragMarker1),this.modImageMarker1.on("dragend",this.onDragEndMarker1),this.modImageMarker1.on("click",this.onClickMarker1),this.modImageMarker2=new h.a.Marker(t,{draggable:"true",icon:this.defaultIcon}),this.modImageMarker2.addTo(this.map),this.modImageMarker2.on("drag",this.onDragMarker2),this.modImageMarker2.on("dragend",this.onDragEndMarker2),this.modImageMarker2.on("click",this.onClickMarker2),this.anchor1ToTopRightNormedDist=0,this.anchor1ToBottomLeftNormedDist=this.imDiag,this.anchor1ToTopLeftNormedDist=this.imWeight,this.anchor1ToBottomRightNormedDist=this.imHeight,this.anchor2ToTopRightNormedDist=this.imDiag,this.anchor2ToBottomLeftNormedDist=0,this.anchor2ToTopLeftNormedDist=this.imHeight,this.anchor2ToBottomRightNormedDist=this.imWeight,this.distBetweenAnchorsNormed=this.imDiag},addPolyline:function(){console.log("addPolyline"),this.circleMarkerEditorAdd.enable(),this.isPolylineEditorAdd=!0,this.isPolygonEditorMod=!1,this.isPolygonEditorDel=!1},cancelAddPolyline:function(){console.log("cancelAddPolyline"),this.circleMarkerEditorAdd.disable(),this.isPolylineEditorAdd=!1,this.editableLayers.getLayers().length?this.isEditable=!1:this.isEditable=!0,this.unselectVertex(),this.draftLayer.clearLayers()},addPolygon:function(){console.log("addPolygon"),this.polygonEditorAdd.enable(),this.isPolygonEditorAdd=!0,this.isPolygonEditorMod=!1,this.isPolygonEditorDel=!1},cancelAddPolygon:function(){console.log("cancelAddPolygon"),this.polygonEditorAdd.disable(),this.isPolygonEditorAdd=!1},confirmAddPolygon:function(){this.polygonEditorAdd.completeShape(),this.cancelAddPolygon()},removeLastVertexPolygon:function(){this.polygonEditorAdd.deleteLastVertex()},editPolygon:function(){console.log("editPolygon"),this.isPolylineEditorAdd?this.cancelAddPolyline():this.isPolygonEditorAdd?this.confirmAddPolygon():this.isPolygonEditorDel&&this.confirmDelPolygon(),this.polygonEditorMod.enable(),this.isPolygonEditorMod=!0,this.addMidpoints(),this.backupLinesList=new Map(this.linesList),this.backupPointsList=new Map(this.pointsList),this.backupEditableLayers=h.a.featureGroup(this.editableLayers.getLayers(),this.editableLayers.options)},cancelModPolygon:function(){if(console.log("cancelModPolygon"),this.polygonEditorMod.revertLayers(),this.polygonEditorMod.disable(),this.isPolygonEditorMod=!1,this.displayCreatedLines(),this.midpointsLayer.clearLayers(),this.editableLayers.clearLayers(),this.backupEditableLayers){var e=this;this.backupEditableLayers.eachLayer((function(t){e.editableLayers.addLayer(t)}))}this.backupEditableLayers=null,this.backupLinesList&&(this.linesList=this.backupLinesList,this.pointsList=this.backupPointsList,this.backupLinesList=new Map,this.backupPointsList=new Map,this.displayCreatedLines())},confirmModPolygon:function(){this.polygonEditorMod.save(),this.polygonEditorMod.disable(),this.isPolygonEditorMod=!1,this.midpointsLayer.clearLayers(),this.backupEditableLayers=null,this.backupLinesList=null,this.backupPointsList=null},deletePolygon:function(){console.log("deletePolygon"),this.isPolylineEditorAdd?this.cancelAddPolyline():this.isPolygonEditorAdd?this.confirmAddPolygon():this.isPolygonEditorMod&&this.confirmModPolygon(),this.polygonEditorDel.enable(),console.log("this.polygonEditorDel"),console.log(this.polygonEditorDel),this.isPolygonEditorDel=!0,this.isEltDeleted=!1,this.backupLinesList=new Map(this.linesList),this.backupPointsList=new Map(this.pointsList),this.unselectVertex()},cancelDelPolygon:function(){this.isPolygonEditorDel&&(this.polygonEditorDel.revertLayers(),this.polygonEditorDel.disable(),this.isPolygonEditorDel=!1,this.linesList=this.backupLinesList,this.pointsList=this.backupPointsList,this.backupLinesList=new Map,this.backupPointsList=new Map,this.displayCreatedLines())},confirmDelPolygon:function(){this.polygonEditorDel.save(),this.polygonEditorDel.disable(),this.isPolygonEditorDel=!1,this.backupLinesList=null,this.backupPointsList=null},drawLineToLastVertex:function(e){this.lastPolylineVertexId&&this.drawLineBetween(this.lastPolylineVertexId,e),this.selectVertex(e)},displayCreatedLines:function(){var e=this;this.linesLayers.clearLayers(),this.linesList.forEach((function(t,o){var i=e.editableLayers._layers[t.point1]._latlng,a=e.editableLayers._layers[t.point2]._latlng;console.log("coord1"),console.log(i),console.log("coord2"),console.log(a);var n=[i,a],s=h.a.polyline(n,{color:"#4C99D4",id:o,direction:t.direction,point1:t.point1,point2:t.point2});e.linesLayers.addLayer(s)})),this.linesLayers.bringToBack()},onPointRightClick:function(e){null===this.lastPolylineVertexId?this.selectVertex(e.target._leaflet_id):(document.getElementById("contextMenu").style.left=e.containerPoint.x+"px",document.getElementById("contextMenu").style.top=e.containerPoint.y+"px",e.target._leaflet_id===this.lastPolylineVertexId?(this.isSelectAvailable=!1,this.isUnselectAvailable=!0):(this.isSelectAvailable=!0,this.isUnselectAvailable=!1,this.rightClickedVertex=e.target._leaflet_id),this.isContextMenu=!0,console.log("onPointRightClick"),console.log(e))},selectVertex:function(e){console.log("selectVertex"),console.log(e),console.log("this.editableLayers._layers[this.lastPolylineVertexId]"),console.log(this.editableLayers._layers[this.lastPolylineVertexId]),this.unselectVertex(),this.lastPolylineVertexId=e,this.editableLayers._layers[e].setStyle({weight:3,radius:10})},unselectVertex:function(){null!==this.lastPolylineVertexId&&this.editableLayers._layers[this.lastPolylineVertexId].setStyle(this.drawPluginOptions.draw.circlemarker),this.lastPolylineVertexId=null},onPointClick:function(e){this.isPolygonEditorDel&&(this.deleteLinesTo(e.sourceTarget._leaflet_id),console.log("this.linesList"),console.log(this.linesList),console.log("this.pointsList"),console.log(this.pointsList))},onLineClick:function(e){if(console.log("onLineClick"),console.log(e),this.selectedLineLayer.clearLayers(),this.isPolygonEditorDel){var t=e.sourceTarget.options.id;this.deleteLine(t)}else{var o=h.a.polyline(e.layer._latlngs,{color:"#61C1D2",id:e.sourceTarget.options.id,direction:e.sourceTarget.options.direction,point1:e.sourceTarget.options.point1,point2:e.sourceTarget.options.point2});console.log("e.sourceTarget.options.direction"),console.log(e.sourceTarget.options.direction),this.store.commit("setSelectedRouteDirection",e.sourceTarget.options.direction),this.selectedLineLayer.addLayer(o),console.log("this.linesList"),console.log(this.linesList)}},deleteLinesTo:function(e){for(var t=this.pointsList.get(e),o=0;o<t.length;o++)this.linesList.delete(t[o]);this.pointsList.delete(e),this.displayCreatedLines()},deleteLine:function(e){this.linesList.delete(e),this.displayCreatedLines()},rightClickSelectVertex:function(){this.selectVertex(this.rightClickedVertex),this.isContextMenu=!1},rightClickUnselectVertex:function(){this.unselectVertex(),this.isContextMenu=!1},rightClickCreateLine:function(){for(var e=this.pointsList.get(this.lastPolylineVertexId),t=!0,o=0;o<e.length;o++)if(e[o]===this.rightClickedVertex){this.isContextMenu=!1,t=!1;break}t&&(this.drawLineToLastVertex(this.rightClickedVertex),this.displayCreatedLines(),this.isContextMenu=!1)},draftLineToMouse:function(e){var t=e.latlng,o=this.editableLayers._layers[this.lastPolylineVertexId]._latlng,i=[t,o],a=h.a.polyline(i,{color:"#4C99D4",opacity:.8,dashArray:"10"});this.draftLayer.clearLayers(),this.draftLayer.addLayer(a)},addMidpoints:function(){var e=this;this.linesList.forEach((function(t,o){var i=e.editableLayers._layers[t.point1]._latlng,a=e.editableLayers._layers[t.point2]._latlng;console.log("coord1"),console.log(i),console.log("coord2"),console.log(a);var n=Object(T["a"])(O(i),O(a));console.log("lineMidpointCoord"),console.log(n);var s=h.a.latLng({lat:n.geometry.coordinates[1],lng:n.geometry.coordinates[0]});console.log("lineMidpointCoordLatLng"),console.log(s);var r=h.a.circleMarker(s,{fillColor:"#4C99D4",radius:5,stroke:!1,opacity:1,fillOpacity:1,id:o,point1:t.point1,point2:t.point2});e.midpointsLayer.addLayer(r)}))},onHoverMidpoint:function(e){e.sourceTarget.setRadius(10),this.polygonEditorMod._tooltip.updateContent({text:h.a.drawLocal.edit.handlers.edit.tooltip.text,subtext:"Cliquer pour créer un point sur ce chemin."})},onHoverEndMidpoint:function(e){e.sourceTarget.setRadius(5),this.polygonEditorMod._tooltip.updateContent({text:h.a.drawLocal.edit.handlers.edit.tooltip.text,subtext:h.a.drawLocal.edit.handlers.edit.tooltip.subtext})},onClickMidpoint:function(e){var t=e.sourceTarget.options.id;this.deleteLine(t);var o=e.sourceTarget.options.point1,i=e.sourceTarget.options.point2,a=h.a.circleMarker(e.sourceTarget._latlng,this.drawPluginOptions.draw.circlemarker);a.on("contextmenu",this.onPointRightClick),a.on("click",this.onPointClick),this.editableLayers.addLayer(a);var n=a._leaflet_id;console.log("lineMidpointId"),console.log(n),this.drawLineBetween(o,n),this.drawLineBetween(n,i),this.displayCreatedLines(),this.midpointsLayer.clearLayers(),this.addMidpoints(),this.polygonEditorMod._tooltip.updateContent({text:h.a.drawLocal.edit.handlers.edit.tooltip.text,subtext:h.a.drawLocal.edit.handlers.edit.tooltip.subtext})},drawLineBetween:function(e,t){this.linesLastId++,this.linesList.set(this.linesLastId,{point1:e,point2:t,direction:this.selectedRouteDirection}),this.pointsList.has(e)?this.pointsList.get(e).push(this.linesLastId):this.pointsList.set(e,[this.linesLastId]),this.pointsList.has(t)?this.pointsList.get(t).push(this.linesLastId):this.pointsList.set(t,[this.linesLastId]),console.log("this.linesList"),console.log(this.linesList),console.log("this.pointsList"),console.log(this.pointsList)},addOverlays:function(){this.layerControl=this.$refs.control.mapObject;var e=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(e,"GeoportailFrance.PlanIGN.Uni"),this.map.addLayer(e);var t=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(t,"GeoportailFrance.PlanIGN");var o=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=bdparcellaire_b&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=CADASTRALPARCELS.PARCELS&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(o,"GeoportailFrance.Parcels.White");var i=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=bdparcellaire_o&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=CADASTRALPARCELS.PARCELS&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(i,"GeoportailFrance.Parcels.Orange");var a=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=ADMINEXPRESS_COG_CARTO_2018&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(a,"GeoportailFrance.COG.Carto");var n=h.a.tileLayer("https://wxs.ign.fr/choisirgeoportail/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE=normal&TILEMATRIXSET=PM&FORMAT=image/png&LAYER=ADMINEXPRESS_COG_2018&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',subdomains:"abcd",minZoom:0,maxZoom:20});this.layerControl.addOverlay(n,"GeoportailFrance.COG");var s=h.a.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}{r}.{ext}",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"});this.layerControl.addOverlay(s,"Stamen.TonerLines");var r=h.a.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-labels/{z}/{x}/{y}{r}.{ext}",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"});this.layerControl.addOverlay(r,"Stamen.TonerLabels")}}};function O(e){return[e.lng,e.lat]}function A(e){return h.a.latLng(e[1],e[0])}var j=R,z=o("2877"),_=o("eebe"),G=o.n(_),Q=o("9989"),q=o("f09f"),B=o("74f7"),V=o("cf57"),F=o("1c1c"),Z=o("66e5"),U=o("4074"),Y=o("c294"),J=o("72db"),W=o("9c40"),X=o("e7a9"),H=o("c1d0"),K=o("0016"),$=Object(z["a"])(j,n,s,!1,null,null,null),ee=$.exports;G()($,"components",{QPage:Q["a"],QCard:q["a"],QInnerLoading:B["a"],QSpinnerGears:V["a"],QList:F["a"],QItem:Z["a"],QItemSection:U["a"],QFab:Y["a"],QFabAction:J["a"],QBtn:W["a"],QBtnGroup:X["a"],QSlider:H["a"],QIcon:K["a"]});var te=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"information-zone"},[o("q-card",{staticClass:"information-card",attrs:{dark:""}},[o("q-item-label",{staticClass:"text-white buttonColor-left list-header",attrs:{header:""}},[e._v("Informations")]),o("q-card-section",[o("div",{staticClass:"row select-type-container"},[o("q-select",{staticClass:"select-type col-10",attrs:{"use-input":"",filled:"","hide-selected":"","fill-input":"",color:"white",dense:"","options-dense":"",options:e.selectOptions,label:"Type"},on:{filter:e.selectFilter},scopedSlots:e._u([{key:"no-option",fn:function(){return[o("q-item",[o("q-item-section",{staticClass:"text-italic text-grey"},[e._v("\n                Aucun résultat\n              ")])],1)]},proxy:!0}]),model:{value:e.selectedElementType,callback:function(t){e.selectedElementType=t},expression:"selectedElementType"}}),o("q-btn",{staticClass:"col-2 add-type-btn",attrs:{flat:"",padding:"xs",color:"white",icon:"fas fa-plus"},on:{click:e.addType}}),o("add-type-dialog",{attrs:{dialogDisplayed:e.dialogDisplayed}})],1)]),o("q-btn",{staticClass:"full-width q-mt-md buttonColor-left save-btn",attrs:{align:"center",icon:"save",label:"Enregister",disabled:""==e.selectedElementType},on:{click:e.saveInformations}})],1)],1)},oe=[],ie=(o("6b54"),o("7f7f"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-dialog",{attrs:{persistent:""},model:{value:e.isDialog,callback:function(t){e.isDialog=t},expression:"isDialog"}},[o("q-card",{staticClass:"add-type-dialog"},[o("q-toolbar",[o("q-avatar",[o("q-icon",{attrs:{color:"primary",name:"fas fa-pen"}})],1),o("q-toolbar-title",{staticClass:"dialog-title"},[e._v("Nouveau type")]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",round:"",dense:"",icon:"close"}})],1),o("q-card-section",[o("q-form",{staticClass:"row",on:{submit:e.onSubmit,reset:e.onReset}},[o("div",{staticClass:"q-gutter-y-md col-6 q-pr-sm "},[o("q-input",{staticClass:"dialog-element",attrs:{dense:"",standout:"",label:"Nom",color:"white"},model:{value:e.typeName,callback:function(t){e.typeName=t},expression:"typeName"}}),o("q-input",{staticClass:"dialog-element",attrs:{dense:"",standout:"",label:"Description",color:"white"},model:{value:e.typeDesc,callback:function(t){e.typeDesc=t},expression:"typeDesc"}}),o("q-input",{staticClass:"dialog-element",attrs:{dense:"",standout:"",label:"Couleur",rules:["anyColor"]},on:{blur:e.setColor},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("span",{attrs:{id:"color-square"}},[o("i",{staticClass:"fas fa-square"})])]},proxy:!0},{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"colorize"}},[o("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-color",{model:{value:e.typeColor,callback:function(t){e.typeColor=t},expression:"typeColor"}})],1)],1)]},proxy:!0}]),model:{value:e.typeColor,callback:function(t){e.typeColor=t},expression:"typeColor"}})],1),o("div",{staticClass:"q-gutter-y-md col-6 q-pl-sm q-mt-auto q-mb-auto"},[o("div",[o("q-space"),o("q-badge",{attrs:{color:"primary"}},[e._v("\n              Épaisseur: "+e._s(e.typeSize)+" px\n            ")]),o("q-slider",{attrs:{min:0,max:20,step:1,color:"primary"},model:{value:e.typeSize,callback:function(t){e.typeSize=t},expression:"typeSize"}})],1),o("div",[o("q-badge",{attrs:{color:"primary"}},[e._v("\n              Visible pour les zooms: "+e._s(e.typeZoomRange.min)+" à "+e._s(e.typeZoomRange.max)+"\n            ")]),o("q-range",{attrs:{min:0,max:20,step:1,color:"primary"},model:{value:e.typeZoomRange,callback:function(t){e.typeZoomRange=t},expression:"typeZoomRange"}})],1)]),o("div",{staticClass:"q-ml-auto"},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),o("q-btn",{attrs:{flat:"",loading:e.progress,type:"submit",color:"primary"},scopedSlots:e._u([{key:"loading",fn:function(){return[o("q-spinner-facebook",{staticClass:"on-center"})]},proxy:!0}])},[e._v("\n            Valider\n            ")])],1)])],1)],1)],1)}),ae=[],ne={name:"AddTypeDialog",props:{dialogDisplayed:{type:Boolean}},data:function(){return{isDialog:!1,fileModel:null,progress:!1,fileText:"",acceptedFormats:".png",placeholder:"File",image:null,typeName:"",typeDesc:"",typeZoomRange:{min:5,max:19},typeColor:"#ffffff",typeSize:3}},watch:{dialogDisplayed:function(e){this.isDialog=!0}},methods:{setColor:function(){console.log("setColor"),console.log(this.typeColor),document.getElementById("color-square").style.color=this.typeColor},onSubmit:function(){var e=this;console.log("confirmForm"),this.isDialog=!1;var t="http://localhost:8098/api/elementType/"+this.typeName+"/"+this.typeDesc,o={method:"POST",redirect:"follow"};fetch(t,o).then((function(e){return e.text()})).then((function(t){console.log("result"),console.log(t);var o=JSON.parse(t).id,i="http://localhost:8098/api/elementTypeStyle/"+o+"/"+e.typeName+"/1/"+e.typeColor.substr(1)+"/"+e.typeZoomRange.min+"/"+e.typeZoomRange.max+"/"+e.typeSize,a={method:"PUT",redirect:"follow"};fetch(i,a).then((function(e){return e.text()})).then((function(e){console.log("result"),console.log(e)})).catch((function(e){return console.log("error",e)}))})).catch((function(e){return console.log("error",e)}))},onReset:function(){}}},se=ne,re=o("24e8"),le=o("65c6"),ce=o("cb32"),de=o("6ac5"),ge=o("a370"),pe=o("0378"),he=o("27f9"),me=o("7cbe"),ue=o("b498"),ye=o("2c91"),Le=o("58a8"),fe=o("7bbf"),Ie=o("e669"),be=o("7f67"),Me=Object(z["a"])(se,ie,ae,!1,null,null,null),we=Me.exports;G()(Me,"components",{QDialog:re["a"],QCard:q["a"],QToolbar:le["a"],QAvatar:ce["a"],QIcon:K["a"],QToolbarTitle:de["a"],QBtn:W["a"],QCardSection:ge["a"],QForm:pe["a"],QInput:he["a"],QPopupProxy:me["a"],QColor:ue["a"],QSpace:ye["a"],QBadge:Le["a"],QSlider:H["a"],QRange:fe["a"],QSpinnerFacebook:Ie["a"]}),G()(Me,"directives",{ClosePopup:be["a"]});var Te={name:"InformationCard",components:{"add-type-dialog":we},data:function(){return{store:x["a"],elementTypes:[],selectOptions:[],selectedElementType:"",dialogDisplayed:!1}},created:function(){var e=this,t="http://localhost:8098/api/elementType/all",o={method:"GET",redirect:"follow"};fetch(t,o).then((function(e){return e.text()})).then((function(t){console.log("element Types"),console.log(t),t=JSON.parse(t).ElementTypes;for(var o=null,i=0;i<t.length;i++)o={label:t[i].name,value:t[i]},e.elementTypes.push(o);e.selectOptions=e.elementTypes})).catch((function(e){return console.log("error",e)}))},methods:{saveInformations:function(){console.log("saveInformations"),console.log("this.selectedElementType"),console.log(this.selectedElementType.value.id);for(var e="http://localhost:8098/api/shape/import",t=new FormData,o=JSON.parse(this.store.state.importedDataGeoJSON),i={type:{id:this.selectedElementType.value.id.toString(),name:this.selectedElementType.value.name,description:this.selectedElementType.value.description},elements:[]},a=0;a<o.features.length;a++){var n={name:o.features[a].properties.name,shortname:o.features[a].properties.shortname?o.features[a].properties.shortname:o.features[a].properties.name,description:o.features[a].properties.description?o.features[a].properties.description:"",issue:"3",geometry:o.features[a].geometry};i.elements.push(n)}console.log("importedDataFormated"),console.log(JSON.stringify(i)),t.append("json",JSON.stringify(i));var s={method:"POST",body:t,redirect:"follow"};fetch(e,s).then((function(e){return e.text()})).then((function(e){console.log("result import"),console.log(e)})).catch((function(e){return console.log("error",e)})),this.store.commit("setInfoPanelDisplayed",!1)},selectFilter:function(e,t){var o=this;t((function(){if(""===e)o.selectOptions=o.elementTypes;else{var t=e.toLowerCase();o.selectOptions=o.elementTypes.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}}),(function(t){""!==e&&t.options.length>0&&-1===t.optionIndex&&(t.moveOptionSelection(1,!0),t.toggleOption(t.options[t.optionIndex],!0))}))},addType:function(){console.log("addType"),this.dialogDisplayed=!this.dialogDisplayed}}},Ee=Te,xe=o("0170"),Ce=o("ddd8"),ve=Object(z["a"])(Ee,te,oe,!1,null,null,null),De=ve.exports;G()(ve,"components",{QCard:q["a"],QItemLabel:xe["a"],QCardSection:ge["a"],QSelect:Ce["a"],QItem:Z["a"],QItemSection:U["a"],QBtn:W["a"]});var Se=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"information-zone"},[o("q-card",{staticClass:"information-card",attrs:{dark:""}},[o("q-item-label",{staticClass:"text-white buttonColor-left list-header",attrs:{header:""}},[e._v("Informations")]),o("q-card-section",[o("div",[e._v("Sens de circulation")]),o("q-btn-group",{staticClass:"infoPanelBtnGroup"},[o("q-btn",{attrs:{id:"twoWayDirections",color:2==e.selectedRouteDirection?"white":"none","text-color":2==e.selectedRouteDirection?"primary":"white",icon:"fas fa-exchange-alt"},on:{click:function(t){return e.selectDirection(2)}}}),o("q-btn",{attrs:{color:1==e.selectedRouteDirection?"white":"none","text-color":1==e.selectedRouteDirection?"primary":"white",icon:"fas fa-long-arrow-alt-up"},on:{click:function(t){return e.selectDirection(1)}}}),o("q-btn",{attrs:{color:-1==e.selectedRouteDirection?"white":"none","text-color":-1==e.selectedRouteDirection?"primary":"white",icon:"fas fa-long-arrow-alt-down"},on:{click:function(t){return e.selectDirection(-1)}}})],1)],1),o("q-btn",{staticClass:"full-width q-mt-md buttonColor-left save-btn",attrs:{align:"center",icon:"save",label:"Enregister",disabled:""==e.selectedRouteDirection},on:{click:e.saveInformations}})],1)],1)},Pe=[],ke={name:"RouteInformationCard",components:{},data:function(){return{store:x["a"],elementTypes:[],dialogDisplayed:!1}},created:function(){},computed:{selectedRouteDirection:function(){return this.store.state.selectedRouteDirection}},methods:{selectDirection:function(e){this.store.commit("setSelectedRouteDirection",e)},saveInformations:function(){console.log("saveInformations")},selectFilter:function(e,t){var o=this;t((function(){if(""===e)o.selectOptions=o.elementTypes;else{var t=e.toLowerCase();o.selectOptions=o.elementTypes.filter((function(e){return e.label.toLowerCase().indexOf(t)>-1}))}}),(function(t){""!==e&&t.options.length>0&&-1===t.optionIndex&&(t.moveOptionSelection(1,!0),t.toggleOption(t.options[t.optionIndex],!0))}))},addType:function(){console.log("addType"),this.dialogDisplayed=!this.dialogDisplayed}}},Ne=ke,Re=Object(z["a"])(Ne,Se,Pe,!1,null,null,null),Oe=Re.exports;G()(Re,"components",{QCard:q["a"],QItemLabel:xe["a"],QCardSection:ge["a"],QBtnGroup:X["a"],QBtn:W["a"]});var Ae={components:{"map-component":ee,"information-card":De,"route-information-card":Oe},name:"PageIndex",data:function(){return{store:x["a"]}},computed:{isInfoPanelDisplayed:function(){return x["a"].state.isInfoPanelDisplayed},isRouteLevel:function(){return x["a"].state.isRouteLevel}},watch:{}},je=Ae,ze=Object(z["a"])(je,i,a,!1,null,null,null);t["default"]=ze.exports;G()(ze,"components",{QPage:Q["a"]})},"1d2c":function(e,t,o){},"6af5":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNC4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FscXVlXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjAgMzAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIwIDMwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9DQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMl8pO30NCgkuc3Qye2ZpbGw6I0E2QjJFNzt9DQo8L3N0eWxlPg0KPGc+DQoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSIxMS44MjMyIiB5MT0iMTUuNDcxOCIgeDI9IjExLjgyMzIiIHkyPSI0LjQ1MzMiPg0KCQk8c3RvcCAgb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNEM5OUQ0Ii8+DQoJCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiMyRjUyQTAiLz4NCgk8L2xpbmVhckdyYWRpZW50Pg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03Ljc0LDEyLjc4YzAsMCwxLjY0LDAuMzksMy41Mi0xLjU3czEuMzEtNC43MywwLjU0LTYuMDZzMi44OC0wLjQ0LDMuNjIsMS43NWMwLjc0LDIuMTgsMS4xMyw1LjAzLTEsNy4wOQ0KCQlzLTUuMTYsMS43LTYuMTQsMS4wNVM3Ljc0LDEyLjc4LDcuNzQsMTIuNzh6Ii8+DQoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI4LjExOSIgeTE9IjIuMDE2IiB4Mj0iOC4xMTkiIHkyPSIyNy4xMzI5Ij4NCgkJPHN0b3AgIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzRDOTlENCIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojMkY1MkEwIi8+DQoJPC9saW5lYXJHcmFkaWVudD4NCgk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTEuNDQsMjguODhsLTMuMzctMS43OGMwLDAtNC4zLTEwLjM1LTUuNjUtMTMuMzVzLTEuOS00LjgsMC4wNS04Ljc1czYuNzUtNS4yNSw5LjQ1LTMuOXMzLjEzLDEuNjYsMy4xMywxLjY2DQoJCWwtMS40MSwxLjVsLTUuMywwLjQyTDYuMzksNy4yOEw2LjM0LDExLjJsMS42MSw1LjcyTDExLjQ0LDI4Ljg4eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0xNS4wNCwyLjc1QzEyLjQyLDAuODgsNi4xLDIuNzksNC43Niw3LjY5Yy0xLjM0LDQuOS0wLjIyLDYuMDEsMi4wNSwxMS4wNHM0LjYzLDEwLjE1LDQuNjMsMTAuMTUNCgkJczYuNS0xNC4wNyw3LjA4LTE4LjNDMTkuMDksNi4zNSwxNy42Nyw0LjYyLDE1LjA0LDIuNzV6IE0xNS4xMiwxMC45N2MtMC41OSwxLjc5LTIuNyw0LjA5LTUuNDIsMy4yMVM2LjU0LDkuNzQsOC4zOCw3LjE5DQoJCWMxLjA4LTEuNSwzLjE5LTIuMzMsNS4wMy0xLjQyQzE1LjI0LDYuNjgsMTUuNzEsOS4xOCwxNS4xMiwxMC45N3oiLz4NCjwvZz4NCjwvc3ZnPg0K"},cf23:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyNC4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FscXVlXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjAgMzAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIwIDMwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDp1cmwoI1NWR0lEXzFfKTt9DQoJLnN0MXtmaWxsOnVybCgjU1ZHSURfMl8pO30NCgkuc3Qye2ZpbGw6IzYxQzFEMjt9DQo8L3N0eWxlPg0KPGc+DQoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8xXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSIxMS44MjMyIiB5MT0iMTUuNDcxOCIgeDI9IjExLjgyMzIiIHkyPSI0LjQ1MzMiPg0KCQk8c3RvcCAgb2Zmc2V0PSIwIiBzdHlsZT0ic3RvcC1jb2xvcjojNEM5OUQ0Ii8+DQoJCTxzdG9wICBvZmZzZXQ9IjEiIHN0eWxlPSJzdG9wLWNvbG9yOiMyRjUyQTAiLz4NCgk8L2xpbmVhckdyYWRpZW50Pg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03Ljc0LDEyLjc4YzAsMCwxLjY0LDAuMzksMy41Mi0xLjU3czEuMzEtNC43MywwLjU0LTYuMDZzMi44OC0wLjQ0LDMuNjIsMS43NWMwLjc0LDIuMTgsMS4xMyw1LjAzLTEsNy4wOQ0KCQlzLTUuMTYsMS43LTYuMTQsMS4wNVM3Ljc0LDEyLjc4LDcuNzQsMTIuNzh6Ii8+DQoJPGxpbmVhckdyYWRpZW50IGlkPSJTVkdJRF8yXyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI4LjExOSIgeTE9IjIuMDE2IiB4Mj0iOC4xMTkiIHkyPSIyNy4xMzI5Ij4NCgkJPHN0b3AgIG9mZnNldD0iMCIgc3R5bGU9InN0b3AtY29sb3I6IzRDOTlENCIvPg0KCQk8c3RvcCAgb2Zmc2V0PSIxIiBzdHlsZT0ic3RvcC1jb2xvcjojMkY1MkEwIi8+DQoJPC9saW5lYXJHcmFkaWVudD4NCgk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTEuNDQsMjguODhsLTMuMzctMS43OGMwLDAtNC4zLTEwLjM1LTUuNjUtMTMuMzVzLTEuOS00LjgsMC4wNS04Ljc1czYuNzUtNS4yNSw5LjQ1LTMuOXMzLjEzLDEuNjYsMy4xMywxLjY2DQoJCWwtMS40MSwxLjVsLTUuMywwLjQyTDYuMzksNy4yOEw2LjM0LDExLjJsMS42MSw1LjcyTDExLjQ0LDI4Ljg4eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0xNS4wNCwyLjc1QzEyLjQyLDAuODgsNi4xLDIuNzksNC43Niw3LjY5Yy0xLjM0LDQuOS0wLjIyLDYuMDEsMi4wNSwxMS4wNHM0LjYzLDEwLjE1LDQuNjMsMTAuMTUNCgkJczYuNS0xNC4wNyw3LjA4LTE4LjNDMTkuMDksNi4zNSwxNy42Nyw0LjYyLDE1LjA0LDIuNzV6IE0xNS4xMiwxMC45N2MtMC41OSwxLjc5LTIuNyw0LjA5LTUuNDIsMy4yMVM2LjU0LDkuNzQsOC4zOCw3LjE5DQoJCWMxLjA4LTEuNSwzLjE5LTIuMzMsNS4wMy0xLjQyQzE1LjI0LDYuNjgsMTUuNzEsOS4xOCwxNS4xMiwxMC45N3oiLz4NCjwvZz4NCjwvc3ZnPg0K"},e526:function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-dialog",{attrs:{persistent:""},model:{value:e.isDialog,callback:function(t){e.isDialog=t},expression:"isDialog"}},[o("q-card",[o("q-toolbar",[o("q-avatar",[o("q-icon",{attrs:{name:"file_download"}})],1),o("q-toolbar-title",[e._v("Selectionner le fichier à importer")]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),o("q-card-section",[o("q-file",{attrs:{color:"primary",filled:"",accept:e.acceptedFormats,label:e.placeholder},on:{rejected:e.onRejected},scopedSlots:e._u([{key:"prepend",fn:function(){return[o("q-icon",{attrs:{name:"insert_drive_file"}})]},proxy:!0}]),model:{value:e.fileModel,callback:function(t){e.fileModel=t},expression:"fileModel"}})],1),o("q-card-actions",{attrs:{align:"right"}},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),o("q-btn",{attrs:{flat:"",loading:e.progress,color:"primary",disabled:!e.fileModel},on:{click:e.importFile},scopedSlots:e._u([{key:"loading",fn:function(){return[o("q-spinner-facebook",{staticClass:"on-center"})]},proxy:!0}])},[e._v("\n        Import\n        ")])],1)],1)],1)},a=[],n=(o("7f7f"),o("28a5"),o("e94f")),s={name:"ImportDialog",props:{dialogOptions:{type:Object,importedData:null}},data:function(){return{isDialog:!1,fileModel:null,progress:!1,fileText:"",acceptedFormats:".png",placeholder:"File",image:null}},watch:{dialogOptions:function(e){this.placeholder=e.placeholder,this.acceptedFormats=e.acceptedFormats,this.fileModel=null,this.progress=!1,this.isDialog=!0},fileModel:function(e){console.log("fileModel"),console.log(e)}},methods:{onRejected:function(e){this.$q.notify({type:"negative",message:"Given file is not in a supported format"})},importFile:function(){var e=this;if(this.progress=!0,console.log("this.fileModel"),console.log(this.fileModel),this.fileModel.size>2e7)this.$q.notify({type:"negative",message:"Given file is too large to be imported"}),this.progress=!1;else{var t=this.fileModel.name.split("."),o=t[t.length-1],i=new FileReader;"kml"===o||"json"===o?(i.addEventListener("load",(function(t){if(e.fileText=t.target.result,"kml"===o){var i=(new DOMParser).parseFromString(e.fileText,"text/xml");e.importedData=JSON.stringify(Object(n["kml"])(i))}else e.importedData=e.fileText;e.$emit("importedData",e.importedData),e.progress=!1,e.isDialog=!1})),i.readAsText(this.fileModel)):(this.$emit("importedData",this.fileModel),this.progress=!1,this.isDialog=!1)}}}},r=s,l=o("2877"),c=o("eebe"),d=o.n(c),g=o("24e8"),p=o("f09f"),h=o("65c6"),m=o("cb32"),u=o("0016"),y=o("6ac5"),L=o("9c40"),f=o("a370"),I=o("7d53"),b=o("4b7e"),M=o("e669"),w=o("7f67"),T=Object(l["a"])(r,i,a,!1,null,null,null);t["a"]=T.exports;d()(T,"components",{QDialog:g["a"],QCard:p["a"],QToolbar:h["a"],QAvatar:m["a"],QIcon:u["a"],QToolbarTitle:y["a"],QBtn:L["a"],QCardSection:f["a"],QFile:I["a"],QCardActions:b["a"],QSpinnerFacebook:M["a"]}),d()(T,"directives",{ClosePopup:w["a"]})},f33e:function(e,t,o){}}]);