(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"07a4":function(e,t,a){"use strict";var r=a("2b0e"),o=a("2f62");r["default"].use(o["a"]),t["a"]=new o["a"].Store({state:{elementsByType:null},mutations:{setElementsByType:function(e,t){console.log("setElementsByType triggered with"),console.log(t),e.elementsByType=t}}})},"713b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-layout",{attrs:{view:"lHr Lpr lFr"}},[a("q-header",{attrs:{elevated:"",id:"Qheader"}},[a("q-toolbar",[a("treeselect",{staticStyle:{width:"100%"},attrs:{name:"demo",multiple:!1,clearable:!0,searchable:!0,disabled:!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"close-on-select":!0,"always-open":!1,"append-to-body":!1,options:e.types,limit:3,"max-height":200,"flatten-search-results":!0,placeholder:"Place"},model:{value:e.selectedElement,callback:function(t){e.selectedElement=t},expression:"selectedElement"}}),a("QrCodeReader")],1)],1),a("q-page-container",[a("router-view")],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"playlist_add_check",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[e._v(e._s(this.validText))])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary"},on:{click:function(t){return e.validate()}}},[e._v(e._s(this.validButton))])],1)],1)],1)],1)},o=[],n=(a("f559"),a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"col text-center"},[a("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.showCamera,expression:"!showCamera"}],attrs:{flat:"",round:"",color:"white",size:"lg",icon:"img:statics\\QrCode.png"},on:{click:function(t){return e.turnCameraOn()}}}),e.showCamera?a("q-popup-proxy",{attrs:{breakpoint:1024},on:{hide:function(t){return e.close()}}},[a("q-card",[a("q-banner",{directives:[{name:"show",rawName:"v-show",value:""!==e.text,expression:"text !== ''"}],staticClass:"bg-grey-3",scopedSlots:e._u([{key:"avatar",fn:function(){return[a("q-icon",{attrs:{name:"videocam_off",color:"primary"}})]},proxy:!0},{key:"action",fn:function(){return[a("q-btn",{attrs:{flat:"",color:"primary",label:"Fermer"},on:{click:function(t){return e.turnCameraOff()}}})]},proxy:!0}],null,!1,3921854672)},[e._v("\n          "+e._s(e.text)+"\n        ")]),a("qrcode-stream",{attrs:{camera:e.camera},on:{init:e.onInit,decode:e.onDecode}})],1)],1):e._e()],1)])}),i=[],s=a("a34a"),l=a.n(s),c=(a("96cf"),a("c973")),u=a.n(c),p=a("9a3e"),m=a("18d6"),d={name:"QrCodeReader",components:{QrcodeStream:p["QrcodeStream"]},data:function(){return{isValid:void 0,camera:"auto",result:null,showCamera:!1,booleanState:!1,popup:!0,text:"",error:""}},methods:{onDecode:function(e){var t=this;return u()(l.a.mark((function a(){return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.result=e,t.turnCameraOff(),m["a"].set("objectId",e);case 3:case"end":return a.stop()}}),a)})))()},close:function(){this.showCamera=!1},turnCameraOn:function(){this.camera="auto",this.showCamera=!0,this.booleanState=!1},turnCameraOff:function(){this.showCamera=!1,this.popup=!1,this.camera="off",this.booleanState=!0},onInit:function(e){var t=this;return u()(l.a.mark((function a(){return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.text="Veuillez activer la caméra",a.next=4,e;case 4:a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](0),"NotAllowedError"===a.t0.name?t.error="L'utilisateur s'est vu refuser l'accès à la caméra":"NotFoundError"===a.t0.name?t.error="Aucun appareil photo approprié n'est installé":"NotSupportedError"===a.t0.name?t.error="La page n'est pas servie sur HTTPS (ou localhost)":"NotReadableError"===a.t0.name?t.error="Peut-être que l'appareil photo est déjà utilisé":"OverconstrainedError"===a.t0.name?t.error="Avez-vous demandé la caméra frontale alors qu'il n'y en a pas ?":"StreamApiNotSupportedError"===a.t0.name&&(t.error="Le navigateur semble manquer de fonctionnalités");case 9:return a.prev=9,a.finish(9);case 11:""!==t.error?t.text=t.error:t.text="";case 12:case"end":return a.stop()}}),a,null,[[0,6,9,11]])})))()}}},h=d,v=a("2877"),f=a("eebe"),b=a.n(f),g=a("9c40"),w=a("7cbe"),y=a("f09f"),q=a("54e1"),x=a("0016"),Q=Object(v["a"])(h,n,i,!1,null,null,null),C=Q.exports;b()(Q,"components",{QBtn:g["a"],QPopupProxy:w["a"],QCard:y["a"],QBanner:q["a"],QIcon:x["a"]});var E=a("ca17"),S=a.n(E),T=(a("542c"),a("07a4")),I={name:"MainLayout",components:{QrCodeReader:C,Treeselect:S.a},data:function(){return{button:"Valider le contrôle",boolean:!0,selectedElement:"",types:[],leftDrawerOpen:!1,rightDrawerOpen:!1,version:"0.0.1",confirm:!1,store:T["a"],object:[],validText:"Voulez-vous valider la maintenance ?",validButton:"Enregistrer et quitter le site",textInfos:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean vehicula leo quis mi vulputate faucibus. Aenean quis odio pharetra, rhoncus enim a, dignissim nisl."}},created:function(){var e=this;this.$q.localStorage.set("object",["","","","",""]);var t=[],a="https://privamap.azurewebsites.net/api/elementType/all",r={method:"GET",redirect:"follow"};fetch(a,r).then((function(e){return e.text()})).then((function(a){a=JSON.parse(a).ElementTypes;for(var r=null,o=0;o<a.length;o++)r={label:a[o].name,value:a[o]},t.push(r);e.store.commit("setElementsByType",t),console.log("elementTypes"),console.log(t);for(var n=0;n<t.length;n++){for(var i=[],s=0;s<t[n].value.Elements.length;s++){var l={id:t[n].value.id+"-"+t[n].value.Elements[s].id,label:t[n].value.Elements[s].name};i.push(l)}var c={id:t[n].value.id,label:t[n].label,children:i};e.types.push(c)}console.log("this.types"),console.log(e.types),e.selectedElement=t[0].value.id})).catch((function(e){return console.log("error",e)})),this.timer=setInterval((function(){var t=e.$q.localStorage.getItem("rightDrawerOpen");e.rightDrawerOpen=!0===t,e.$q.localStorage.getItem("leave")?e.button="Valider la sortie":e.button="Valider le contrôle",e.object=e.$q.localStorage.getItem("object"),null!==e.object&&(e.object[0].startsWith("Déf")?e.textInfos="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean vehicula ...":e.textInfos="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean vehicula leo quis mi vulputate faucibus. Aenean quis odio pharetra, rhoncus enim a, dignissim nisl.")}),100)},watch:{selectedElement:function(e){m["a"].set("objectId",e)}},methods:{verify:function(){this.confirm=!0,this.$q.localStorage.getItem("leave")?(this.boolean=!0,this.validText="Avez-vous quitté le site ?",this.validButton="Confirmer"):(this.boolean=!1,this.validText="Voulez-vous valider la maintenance du "+this.object[0]+"?",this.validButton="Enregistrer et quitter le site")},validate:function(){this.$q.localStorage.set("valid",!0),this.confirm=!0,this.rightDrawerOpen=!1,this.$q.localStorage.getItem("leave")?this.$q.notify({type:"positive",message:"Vous avez quitté le site."}):this.$q.notify({type:"positive",message:"La maintenance du "+this.object[0]+" a bien été validée."})},close:function(){this.$q.localStorage.set("rightDrawerOpen",!1)}}},k=I,O=a("4d5a"),_=a("e359"),j=a("65c6"),A=a("6ac5"),B=a("9404"),L=a("1c1c"),$=a("0170"),D=a("068f"),N=a("eb85"),z=a("cb32"),V=a("09e3"),P=a("24e8"),R=a("a370"),F=a("4b7e"),H=a("7f67"),J=Object(v["a"])(k,r,o,!1,null,null,null);t["default"]=J.exports;b()(J,"components",{QLayout:O["a"],QHeader:_["a"],QToolbar:j["a"],QBtn:g["a"],QToolbarTitle:A["a"],QDrawer:B["a"],QList:L["a"],QItemLabel:$["a"],QImg:D["a"],QSeparator:N["a"],QAvatar:z["a"],QIcon:x["a"],QPageContainer:V["a"],QDialog:P["a"],QCard:y["a"],QCardSection:R["a"],QCardActions:F["a"]}),b()(J,"directives",{ClosePopup:H["a"]})}}]);